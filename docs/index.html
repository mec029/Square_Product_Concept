<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SquareFlow — AI-Native Stockout Risk Engine</title>
<link href="https://fonts.googleapis.com/css2?family=Instrument+Serif:ital@0;1&family=Instrument+Sans:wght@400;500;600&family=DM+Mono:wght@300;400;500&display=swap" rel="stylesheet">
<style>
  :root {
    --bg: #faf7f2;
    --surface: #ffffff;
    --surface2: #f4f0e8;
    --border: #e2d9cc;
    --border-dark: #c8b99f;
    --accent: #c4622d;
    --accent2: #2d6e8e;
    --accent-light: #f0e4d7;
    --danger: #b83232;
    --warn: #b86a1a;
    --ok: #2d7d52;
    --text: #1a1410;
    --text2: #3d3028;
    --muted: #5c4d3d;
    --muted-light: #7a6655;
    --mono: 'DM Mono', monospace;
    --sans: 'Instrument Sans', sans-serif;
    --serif: 'Instrument Serif', serif;
  }

  * { box-sizing: border-box; margin: 0; padding: 0; }

  body {
    background: var(--bg);
    color: var(--text);
    font-family: var(--sans);
    min-height: 100vh;
    overflow-x: hidden;
  }

  /* Subtle linen texture overlay */
  body::before {
    content: '';
    position: fixed;
    inset: 0;
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='4' height='4'%3E%3Crect width='4' height='4' fill='%23faf7f2'/%3E%3Crect x='0' y='0' width='1' height='1' fill='%23e8e0d0' opacity='0.3'/%3E%3Crect x='2' y='2' width='1' height='1' fill='%23e8e0d0' opacity='0.3'/%3E%3C/svg%3E");
    pointer-events: none;
    z-index: 0;
  }

  .container { max-width: 1400px; margin: 0 auto; padding: 0 40px; position: relative; z-index: 1; }

  /* Header */
  header {
    border-bottom: 1px solid var(--border);
    padding: 28px 0;
    margin-bottom: 44px;
    background: var(--surface);
    position: sticky;
    top: 0;
    z-index: 100;
    box-shadow: 0 1px 0 var(--border), 0 4px 24px rgba(26,20,16,0.04);
  }

  .header-inner {
    display: flex;
    align-items: center;
    justify-content: space-between;
    max-width: 1400px;
    margin: 0 auto;
    padding: 0 40px;
  }

  .logo {
    display: flex;
    align-items: center;
    gap: 16px;
  }

  .logo-wordmark {
    display: flex;
    flex-direction: column;
    gap: 1px;
  }

  .logo-tag {
    font-family: var(--mono);
    font-size: 16px;
    color: var(--accent);
    letter-spacing: 0.22em;
    text-transform: uppercase;
  }

  .logo h1 {
    font-family: var(--serif);
    font-size: 26px;
    font-weight: 400;
    font-style: italic;
    letter-spacing: -0.01em;
    color: var(--text);
    line-height: 1;
  }

  .logo-divider {
    width: 1px;
    height: 32px;
    background: var(--border-dark);
    opacity: 0.5;
  }

  .logo-sub {
    font-size: 17px;
    font-weight: 500;
    color: var(--muted);
    letter-spacing: 0.01em;
  }

  .header-meta {
    font-family: var(--mono);
    font-size: 17px;
    color: var(--muted);
    text-align: right;
    line-height: 2;
  }

  .live-dot {
    display: inline-block;
    width: 5px;
    height: 5px;
    background: var(--ok);
    border-radius: 50%;
    margin-right: 6px;
    animation: pulse 2s ease-in-out infinite;
  }

  @keyframes pulse {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.3; }
  }

  /* Stats bar */
  .stats-bar {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 12px;
    margin-bottom: 40px;
  }

  .stat {
    background: var(--surface);
    padding: 24px 28px;
    border: 1px solid var(--border);
    position: relative;
    overflow: hidden;
    transition: all 0.2s ease;
    border-radius: 2px;
  }

  .stat::after {
    content: '';
    position: absolute;
    top: 0; left: 0; right: 0;
    height: 3px;
    background: var(--accent);
    transform: scaleX(0);
    transform-origin: left;
    transition: transform 0.4s ease;
  }

  .stat:hover::after { transform: scaleX(1); }
  .stat:hover { box-shadow: 0 4px 20px rgba(26,20,16,0.08); transform: translateY(-1px); }

  .stat-label {
    font-family: var(--mono);
    font-size: 11px;
    color: var(--muted);
    letter-spacing: 0.18em;
    text-transform: uppercase;
    margin-bottom: 12px;
  }

  .stat-value {
    font-family: var(--serif);
    font-size: 44px;
    font-weight: 400;
    line-height: 1;
    letter-spacing: -0.02em;
  }

  .stat-value.danger { color: var(--danger); }
  .stat-value.warn { color: var(--warn); }
  .stat-value.ok { color: var(--ok); }
  .stat-value.accent { color: var(--accent); }

  .stat-sub {
    font-family: var(--mono);
    font-size: 12px;
    color: var(--muted-light);
    margin-top: 8px;
  }

  /* Main layout */
  .main-grid {
    display: grid;
    grid-template-columns: 1fr 380px;
    gap: 12px;
    margin-bottom: 12px;
  }

  /* Panel */
  .panel {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 2px;
    overflow: hidden;
  }

  .panel-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 18px 28px;
    border-bottom: 1px solid var(--border);
    background: var(--surface2);
  }

  .panel-title {
    font-size: 16px;
    font-weight: 600;
    letter-spacing: 0.1em;
    text-transform: uppercase;
    color: var(--muted);
  }

  .panel-title span { color: var(--text); }

  .panel-badge {
    font-family: var(--mono);
    font-size: 16px;
    padding: 3px 10px;
    letter-spacing: 0.12em;
    border-radius: 1px;
  }

  .badge-danger { background: rgba(184,50,50,0.1); color: var(--danger); border: 1px solid rgba(184,50,50,0.25); }
  .badge-warn { background: rgba(184,106,26,0.1); color: var(--warn); border: 1px solid rgba(184,106,26,0.25); }
  .badge-ok { background: rgba(45,125,82,0.1); color: var(--ok); border: 1px solid rgba(45,125,82,0.25); }
  .badge-accent { background: var(--accent-light); color: var(--accent); border: 1px solid rgba(196,98,45,0.3); }

  /* SKU Table */
  .sku-table { width: 100%; }

  .sku-row {
    display: grid;
    grid-template-columns: 2fr 80px 100px 1fr 120px;
    align-items: center;
    padding: 16px 28px;
    border-bottom: 1px solid var(--border);
    transition: background 0.15s;
    cursor: pointer;
    gap: 16px;
  }

  .sku-row:hover { background: var(--surface2); }
  .sku-row.selected { background: var(--accent-light); border-left: 3px solid var(--accent); }
  .sku-row:last-child { border-bottom: none; }

  .sku-row.header-row {
    font-family: var(--mono);
    font-size: 11px;
    color: var(--muted-light);
    letter-spacing: 0.14em;
    text-transform: uppercase;
    cursor: default;
    padding: 10px 28px;
    background: var(--bg);
  }
  .sku-row.header-row:hover { background: var(--bg); }

  .sku-name { font-weight: 600; font-size: 15px; color: var(--text2); }
  .sku-code { font-family: var(--mono); font-size: 11px; color: var(--muted-light); margin-top: 3px; }

  .sku-stock { font-family: var(--serif); font-size: 20px; font-weight: 400; }
  .sku-velocity { font-family: var(--mono); font-size: 12px; color: var(--muted); }

  /* Risk bar */
  .risk-bar-wrap { display: flex; align-items: center; gap: 10px; }
  .risk-bar-bg {
    flex: 1;
    height: 3px;
    background: var(--border);
    border-radius: 2px;
    overflow: hidden;
  }
  .risk-bar-fill {
    height: 100%;
    border-radius: 2px;
    transition: width 1s cubic-bezier(0.4,0,0.2,1);
  }
  .risk-pct { font-family: var(--mono); font-size: 13px; font-weight: 500; min-width: 36px; text-align: right; }

  .risk-high { background: var(--danger); }
  .risk-med { background: var(--warn); }
  .risk-low { background: var(--ok); }

  /* Action pill */
  .action-pill {
    font-family: var(--mono);
    font-size: 11px;
    padding: 4px 10px;
    border-radius: 1px;
    letter-spacing: 0.1em;
    text-align: center;
    white-space: nowrap;
  }

  /* Right panel — detail */
  .detail-panel { display: flex; flex-direction: column; }

  .detail-content { padding: 28px; flex: 1; }

  .detail-empty {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    height: 100%;
    min-height: 300px;
    color: var(--muted-light);
    font-family: var(--mono);
    font-size: 16px;
    text-align: center;
    gap: 12px;
  }

  .detail-empty .arrow { font-size: 20px; opacity: 0.4; }

  .detail-sku-name {
    font-family: var(--serif);
    font-size: 26px;
    font-weight: 400;
    font-style: italic;
    letter-spacing: -0.01em;
    margin-bottom: 4px;
    color: var(--text);
  }
  .detail-sku-code { font-family: var(--mono); font-size: 12px; color: var(--muted-light); margin-bottom: 24px; }

  /* Risk score big display */
  .risk-score-display {
    background: var(--surface2);
    border: 1px solid var(--border);
    padding: 24px;
    margin-bottom: 16px;
    text-align: center;
    position: relative;
    overflow: hidden;
    border-radius: 2px;
  }

  .risk-score-display::before {
    content: 'RISK SCORE';
    position: absolute;
    top: 12px; left: 16px;
    font-family: var(--mono);
    font-size: 11px;
    color: var(--muted-light);
    letter-spacing: 0.2em;
  }

  .risk-number {
    font-family: var(--serif);
    font-size: 80px;
    font-weight: 400;
    letter-spacing: -0.03em;
    line-height: 1;
    margin-top: 8px;
  }

  .risk-label {
    font-family: var(--mono);
    font-size: 12px;
    letter-spacing: 0.18em;
    margin-top: 6px;
  }

  /* Signal grid */
  .signal-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 8px; margin-bottom: 16px; }

  .signal-card {
    background: var(--surface2);
    border: 1px solid var(--border);
    padding: 14px 16px;
    border-radius: 2px;
  }

  .signal-label {
    font-family: var(--mono);
    font-size: 11px;
    color: var(--muted-light);
    letter-spacing: 0.14em;
    text-transform: uppercase;
    margin-bottom: 6px;
  }

  .signal-value {
    font-family: var(--serif);
    font-size: 24px;
    font-weight: 400;
    letter-spacing: -0.01em;
  }

  .signal-sub {
    font-family: var(--mono);
    font-size: 11px;
    color: var(--muted-light);
    margin-top: 4px;
  }

  /* AI reasoning box */
  .reasoning-box {
    background: var(--accent-light);
    border: 1px solid rgba(196,98,45,0.2);
    padding: 18px;
    margin-bottom: 12px;
    border-radius: 2px;
  }

  .reasoning-label {
    font-family: var(--mono);
    font-size: 11px;
    color: var(--accent);
    letter-spacing: 0.2em;
    margin-bottom: 10px;
  }

  .reasoning-text {
    font-size: 15px;
    line-height: 1.7;
    color: var(--text2);
    font-weight: 400;
  }

  /* Recommendation */
  .recommendation {
    background: var(--surface2);
    border: 1px solid var(--border);
    padding: 18px;
    border-radius: 2px;
  }

  .rec-label {
    font-family: var(--mono);
    font-size: 11px;
    color: var(--accent2);
    letter-spacing: 0.2em;
    margin-bottom: 10px;
  }

  .rec-action {
    font-size: 16px;
    font-weight: 600;
    margin-bottom: 6px;
    color: var(--text);
  }

  .rec-detail {
    font-family: var(--mono);
    font-size: 13px;
    color: var(--muted);
    line-height: 1.7;
  }

  .confidence-bar {
    display: flex;
    align-items: center;
    gap: 10px;
    margin-top: 14px;
    padding-top: 14px;
    border-top: 1px solid var(--border);
  }

  .conf-label { font-family: var(--mono); font-size: 11px; color: var(--muted-light); letter-spacing: 0.12em; }
  .conf-track { flex: 1; height: 2px; background: var(--border); }
  .conf-fill { height: 100%; background: var(--accent2); transition: width 0.8s ease; }
  .conf-pct { font-family: var(--mono); font-size: 13px; color: var(--accent2); }

  /* Simulator panel */
  .simulator {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 2px;
    padding: 28px 36px;
    margin-bottom: 12px;
  }

  .sim-header {
    display: flex;
    align-items: center;
    gap: 12px;
    margin-bottom: 24px;
    padding-bottom: 20px;
    border-bottom: 1px solid var(--border);
  }

  .sim-icon {
    width: 32px;
    height: 32px;
    background: var(--accent-light);
    border: 1px solid rgba(196,98,45,0.2);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 14px;
    border-radius: 1px;
  }

  .sim-title {
    font-size: 13px;
    font-weight: 600;
    color: var(--text2);
    letter-spacing: 0.01em;
  }

  .sim-sub {
    font-family: var(--mono);
    font-size: 17px;
    color: var(--muted-light);
    margin-top: 2px;
  }

  .sim-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 32px; }

  .sim-control label {
    display: block;
    font-family: var(--mono);
    font-size: 16px;
    color: var(--muted);
    letter-spacing: 0.14em;
    text-transform: uppercase;
    margin-bottom: 12px;
  }

  .sim-control input[type="range"] {
    width: 100%;
    accent-color: var(--accent);
    cursor: pointer;
    height: 2px;
  }

  .sim-control .val {
    font-family: var(--serif);
    font-size: 18px;
    color: var(--accent);
    margin-top: 8px;
    font-style: italic;
  }

  /* Footer */
  footer {
    border-top: 1px solid var(--border);
    padding: 28px 0;
    margin-top: 24px;
  }

  .footer-inner {
    display: flex;
    justify-content: space-between;
    align-items: center;
  }

  .footer-text {
    font-family: var(--mono);
    font-size: 17px;
    color: var(--muted-light);
    line-height: 2;
  }

  .footer-brand {
    display: flex;
    align-items: center;
    gap: 10px;
  }

  .footer-logo {
    font-family: var(--serif);
    font-size: 18px;
    font-style: italic;
    color: var(--muted);
  }

  .footer-tag {
    font-family: var(--mono);
    font-size: 16px;
    color: var(--accent);
    border: 1px solid rgba(196,98,45,0.3);
    padding: 3px 10px;
    letter-spacing: 0.12em;
    border-radius: 1px;
  }

  /* Animate in */
  .sku-row { animation: fadeUp 0.5s ease both; }
  @keyframes fadeUp {
    from { opacity: 0; transform: translateY(6px); }
    to { opacity: 1; transform: translateY(0); }
  }

  .sku-row:nth-child(1) { animation-delay: 0.05s; }
  .sku-row:nth-child(2) { animation-delay: 0.10s; }
  .sku-row:nth-child(3) { animation-delay: 0.15s; }
  .sku-row:nth-child(4) { animation-delay: 0.20s; }
  .sku-row:nth-child(5) { animation-delay: 0.25s; }
  .sku-row:nth-child(6) { animation-delay: 0.30s; }
  .sku-row:nth-child(7) { animation-delay: 0.35s; }
  .sku-row:nth-child(8) { animation-delay: 0.40s; }

  .stat { animation: fadeUp 0.5s ease both; }
  .stat:nth-child(1) { animation-delay: 0.0s; }
  .stat:nth-child(2) { animation-delay: 0.08s; }
  .stat:nth-child(3) { animation-delay: 0.16s; }
  .stat:nth-child(4) { animation-delay: 0.24s; }

  .model-note {
    font-family: var(--mono);
    font-size: 12px;
    color: var(--muted-light);
    padding: 12px 28px;
    border-top: 1px solid var(--border);
    background: var(--bg);
  }

  @media (max-width: 1100px) {
    .main-grid { grid-template-columns: 1fr; }
    .stats-bar { grid-template-columns: repeat(2,1fr); }
    .sim-grid { grid-template-columns: repeat(2,1fr); }
    .sku-row { grid-template-columns: 2fr 60px 80px 1fr; }
    .sku-row > *:last-child { display: none; }
  }
  /* Nav tabs */
  .header-nav {
    display: flex;
    gap: 4px;
    background: var(--surface2);
    padding: 4px;
    border: 1px solid var(--border);
    border-radius: 3px;
  }

  .nav-btn {
    font-family: var(--sans);
    font-size: 17px;
    font-weight: 500;
    padding: 6px 16px;
    border: none;
    background: transparent;
    color: var(--muted);
    cursor: pointer;
    border-radius: 2px;
    transition: all 0.15s;
    letter-spacing: 0.01em;
  }

  .nav-btn:hover { color: var(--text); background: var(--surface); }
  .nav-btn.active { background: var(--surface); color: var(--text); box-shadow: 0 1px 4px rgba(26,20,16,0.08); }

  /* Summary page */
  .summary-hero {
    display: grid;
    grid-template-columns: 1fr 420px;
    gap: 40px;
    align-items: center;
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 2px;
    padding: 48px;
    margin-bottom: 40px;
  }

  .summary-eyebrow {
    font-family: var(--mono);
    font-size: 11px;
    color: var(--accent);
    letter-spacing: 0.2em;
    text-transform: uppercase;
    margin-bottom: 12px;
  }

  .summary-title {
    font-family: var(--serif);
    font-size: 40px;
    font-weight: 400;
    font-style: italic;
    letter-spacing: -0.02em;
    color: var(--text);
    line-height: 1.1;
    margin-bottom: 16px;
  }

  .summary-desc {
    font-size: 16px;
    color: var(--muted);
    line-height: 1.7;
    max-width: 480px;
  }

  .summary-formula {
    background: var(--surface2);
    border: 1px solid var(--border);
    padding: 28px;
    border-radius: 2px;
  }

  .formula-label {
    font-family: var(--mono);
    font-size: 11px;
    color: var(--muted-light);
    letter-spacing: 0.2em;
    margin-bottom: 20px;
  }

  .formula-body {
    display: flex;
    align-items: center;
    gap: 10px;
    flex-wrap: wrap;
  }

  .formula-term {
    font-family: var(--mono);
    font-size: 13px;
    padding: 8px 14px;
    border-radius: 2px;
    display: flex;
    flex-direction: column;
    gap: 2px;
    line-height: 1.3;
  }

  .formula-term.v { background: rgba(196,98,45,0.1); color: var(--accent); border: 1px solid rgba(196,98,45,0.2); }
  .formula-term.s { background: rgba(184,106,26,0.1); color: var(--warn); border: 1px solid rgba(184,106,26,0.2); }
  .formula-term.l { background: rgba(184,50,50,0.1); color: var(--danger); border: 1px solid rgba(184,50,50,0.2); }
  .formula-term .fw { font-size: 20px; opacity: 0.8; }
  .formula-op { font-family: var(--mono); color: var(--muted-light); font-size: 18px; }
  .formula-result {
    font-family: var(--serif);
    font-size: 28px;
    font-style: italic;
    color: var(--text);
  }

  .summary-section-label {
    font-family: var(--mono);
    font-size: 11px;
    color: var(--muted-light);
    letter-spacing: 0.2em;
    text-transform: uppercase;
    margin-bottom: 16px;
    padding-bottom: 12px;
    border-bottom: 1px solid var(--border);
  }

  .summary-cards { display: flex; flex-direction: column; gap: 12px; }

  .scard {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 2px;
    padding: 28px;
    display: flex;
    gap: 24px;
    align-items: flex-start;
    transition: box-shadow 0.2s;
  }

  .scard:hover { box-shadow: 0 4px 20px rgba(26,20,16,0.07); }

  .scard-icon {
    width: 44px;
    height: 44px;
    border-radius: 2px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 20px;
    flex-shrink: 0;
    margin-top: 2px;
  }

  .scard-body { flex: 1; }

  .scard-title {
    font-size: 17px;
    font-weight: 600;
    color: var(--text);
    margin-bottom: 4px;
  }

  .scard-range {
    font-family: var(--mono);
    font-size: 11px;
    color: var(--muted-light);
    letter-spacing: 0.1em;
    margin-bottom: 12px;
  }

  .scard-desc {
    font-size: 16px;
    color: var(--muted);
    line-height: 1.7;
    margin-bottom: 14px;
  }

  .scard-formula {
    display: flex;
    align-items: baseline;
    gap: 10px;
    background: var(--surface2);
    border: 1px solid var(--border);
    padding: 10px 14px;
    border-radius: 2px;
  }

  .sf-label {
    font-family: var(--mono);
    font-size: 12px;
    color: var(--muted-light);
    white-space: nowrap;
  }

  .sf-eq {
    font-family: var(--mono);
    font-size: 12px;
    color: var(--text2);
  }

  .summary-signals { display: flex; flex-direction: column; gap: 12px; }

  .signal-explain {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 2px;
    padding: 24px 28px;
  }

  .se-header {
    display: flex;
    align-items: center;
    gap: 16px;
    margin-bottom: 14px;
  }

  .se-weight {
    font-family: var(--serif);
    font-size: 28px;
    font-style: italic;
    width: 72px;
    height: 56px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 2px;
    flex-shrink: 0;
  }

  .se-title { font-size: 17px; font-weight: 600; color: var(--text); }
  .se-sub { font-family: var(--mono); font-size: 11px; color: var(--muted-light); margin-top: 3px; }

  .se-desc {
    font-size: 16px;
    color: var(--muted);
    line-height: 1.7;
    margin-bottom: 12px;
  }

  .se-example {
    font-family: var(--mono);
    font-size: 12px;
    color: var(--text2);
    background: var(--surface2);
    border: 1px solid var(--border);
    padding: 10px 14px;
    border-radius: 2px;
    line-height: 1.6;
  }

  .se-ex-label {
    font-size: 11px;
    letter-spacing: 0.15em;
    color: var(--muted-light);
    text-transform: uppercase;
    margin-right: 8px;
  }

  /* Threshold table */
  .threshold-table {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 2px;
    overflow: hidden;
    margin-bottom: 48px;
  }

  .tt-row {
    display: grid;
    grid-template-columns: 80px 130px 1fr 1fr;
    gap: 20px;
    padding: 18px 28px;
    border-bottom: 1px solid var(--border);
    align-items: start;
  }

  .tt-row:last-child { border-bottom: none; }

  .tt-header {
    font-family: var(--mono);
    font-size: 11px;
    color: var(--muted-light);
    letter-spacing: 0.15em;
    text-transform: uppercase;
    background: var(--surface2);
    padding: 12px 28px;
  }

  .tt-score {
    font-family: var(--serif);
    font-size: 20px;
    font-style: italic;
    padding-top: 2px;
  }

  .tt-desc, .tt-action {
    font-size: 15px;
    color: var(--muted);
    line-height: 1.6;
  }

  .tt-action { color: var(--text2); }

  /* ── Flowchart page ─────────────────────────────────────── */
  .fc-hero {
    display: flex;
    align-items: center;
    justify-content: space-between;
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 2px;
    padding: 48px;
    margin-bottom: 40px;
    gap: 40px;
  }

  .fc-scale-badge {
    flex-shrink: 0;
    text-align: center;
    background: var(--surface2);
    border: 1px solid var(--border);
    padding: 28px 40px;
    border-radius: 2px;
  }

  .fc-scale-num {
    font-family: var(--serif);
    font-size: 64px;
    font-style: italic;
    color: var(--accent);
    line-height: 1;
  }

  .fc-scale-label {
    font-family: var(--mono);
    font-size: 17px;
    color: var(--muted-light);
    letter-spacing: 0.15em;
    margin-top: 6px;
  }

  .fc-section-label {
    font-family: var(--mono);
    font-size: 17px;
    color: var(--muted-light);
    letter-spacing: 0.2em;
    text-transform: uppercase;
    margin-bottom: 20px;
    padding-bottom: 12px;
    border-bottom: 1px solid var(--border);
  }

  /* The chart container */
  .fc-chart {
    background: transparent;
    border: none;
    border-radius: 0;
    padding: 0;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 0;
  }

  .fc-layer {
    width: 100%;
    background: var(--surface2);
    border: 1px solid var(--border);
    border-radius: 2px;
    padding: 20px 24px;
  }

  .fc-layer-hero {
    background: rgba(196,98,45,0.04);
    border-color: rgba(196,98,45,0.3);
    box-shadow: 0 0 0 3px rgba(196,98,45,0.06);
  }

  .fc-layer-label {
    font-family: var(--mono);
    font-size: 17px;
    color: var(--muted);
    letter-spacing: 0.18em;
    text-transform: uppercase;
    margin-bottom: 16px;
  }

  .fc-nodes {
    display: flex;
    align-items: center;
    gap: 8px;
  }

  .fc-nodes-wide { justify-content: space-between; }

  .fc-node {
    flex: 1;
    padding: 16px;
    border-radius: 2px;
    border: 1px solid var(--border);
    background: var(--surface);
    min-width: 0;
  }

  .fc-node-physical { border-color: #c8d8b0; background: #f7fbf2; }
  .fc-node-idcloud  { border-color: #b0c8d8; background: #f2f7fb; }
  .fc-node-sf       { border-color: rgba(196,98,45,0.3); background: rgba(196,98,45,0.04); }
  .fc-node-sf-main  { border-color: var(--accent); background: rgba(196,98,45,0.08); box-shadow: 0 2px 12px rgba(196,98,45,0.12); }
  .fc-node-square   { border-color: #c8b0d8; background: #f9f2fb; }

  .fc-node-icon { font-size: 18px; margin-right: 8px; flex-shrink: 0; }

  .fc-node-header {
    display: flex;
    align-items: center;
    margin-bottom: 8px;
  }

  .fc-node-title {
    font-size: 15px;
    font-weight: 600;
    color: var(--text);
    margin-bottom: 0;
  }

  .fc-node-detail {
    font-size: 14px;
    color: var(--muted);
    line-height: 1.6;
    margin-bottom: 10px;
  }

  .fc-node-code {
    font-family: var(--mono);
    font-size: 11px;
    color: var(--text2);
    background: rgba(26,20,16,0.05);
    padding: 6px 8px;
    border-radius: 2px;
    line-height: 1.7;
  }

  .fc-arrow-h {
    font-size: 20px;
    color: var(--muted-light);
    flex-shrink: 0;
    padding: 0 4px;
    margin-top: -20px;
  }

  .fc-arrow-v {
    font-size: 24px;
    color: var(--muted-light);
    padding: 8px 0;
    line-height: 1;
  }

  .fc-hero-note {
    margin-top: 14px;
    font-family: var(--mono);
    font-size: 16px;
    color: var(--accent);
    text-align: center;
    padding: 10px;
    border-top: 1px solid rgba(196,98,45,0.2);
    letter-spacing: 0.05em;
  }

  /* Scale grid */
  .fc-scale-intro {
    font-size: 14px;
    color: var(--muted);
    line-height: 1.7;
    margin-bottom: 24px;
    max-width: 720px;
  }

  .fc-scale-grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 12px;
    margin-bottom: 8px;
  }

  .fc-scale-card {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 2px;
    padding: 28px;
  }

  .fc-scale-card-mid {
    border-color: var(--border-dark);
    box-shadow: 0 2px 12px rgba(26,20,16,0.06);
  }

  .fc-scale-card-enterprise {
    border-color: var(--accent);
    background: rgba(196,98,45,0.03);
    box-shadow: 0 4px 20px rgba(196,98,45,0.1);
  }

  .fc-scale-tier {
    font-family: var(--mono);
    font-size: 16px;
    color: var(--muted-light);
    letter-spacing: 0.2em;
    text-transform: uppercase;
    margin-bottom: 4px;
  }

  .fc-scale-tier-name {
    font-family: var(--serif);
    font-size: 22px;
    font-style: italic;
    color: var(--text);
    margin-bottom: 4px;
  }

  .fc-scale-stores {
    font-family: var(--mono);
    font-size: 16px;
    color: var(--accent);
    margin-bottom: 20px;
    padding-bottom: 16px;
    border-bottom: 1px solid var(--border);
  }

  .fc-scale-list {
    list-style: none;
    padding: 0;
    display: flex;
    flex-direction: column;
    gap: 10px;
    margin-bottom: 20px;
  }

  .fc-scale-list li {
    font-size: 13px;
    color: var(--muted);
    line-height: 1.5;
    padding-left: 14px;
    position: relative;
  }

  .fc-scale-list li::before {
    content: '→';
    position: absolute;
    left: 0;
    color: var(--accent);
    font-family: var(--mono);
    font-size: 17px;
    top: 2px;
  }

  .fc-scale-complexity {
    font-family: var(--mono);
    font-size: 11px;
    color: var(--muted-light);
    border-top: 1px solid var(--border);
    padding-top: 12px;
    margin-top: 4px;
    letter-spacing: 0.08em;
    text-transform: uppercase;
  }

  /* Principles */
  .fc-principles {
    display: flex;
    flex-direction: column;
    gap: 1px;
    background: var(--border);
    border: 1px solid var(--border);
    border-radius: 2px;
    overflow: hidden;
    margin-bottom: 48px;
  }

  .fc-principle {
    display: flex;
    gap: 28px;
    align-items: flex-start;
    background: var(--surface);
    padding: 24px 28px;
    transition: background 0.15s;
  }

  .fc-principle:hover { background: var(--surface2); }

  .fc-p-num {
    font-family: var(--serif);
    font-size: 28px;
    font-style: italic;
    color: var(--accent);
    opacity: 0.6;
    flex-shrink: 0;
    width: 36px;
    line-height: 1;
    padding-top: 2px;
  }

  .fc-p-title {
    font-size: 15px;
    font-weight: 600;
    color: var(--text);
    margin-bottom: 6px;
  }

  .fc-p-desc {
    font-size: 13px;
    color: var(--muted);
    line-height: 1.7;
  }

  @media (max-width: 1000px) {
    .fc-scale-grid { grid-template-columns: 1fr; }
    .fc-nodes { flex-wrap: wrap; }
    .fc-arrow-h { display: none; }
    .fc-hero { flex-direction: column; }
  }

  /* ── The Problem page ──────────────────────────────────── */
  .prob-opening {
    display: grid;
    grid-template-columns: 1fr 380px;
    gap: 48px;
    align-items: center;
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 2px;
    padding: 56px 52px;
    margin-bottom: 40px;
    position: relative;
    overflow: hidden;
  }

  .prob-opening::before {
    content: '';
    position: absolute;
    top: 0; left: 0; right: 0;
    height: 3px;
    background: linear-gradient(90deg, var(--danger), var(--accent));
  }

  .prob-headline {
    font-family: var(--serif);
    font-size: 44px;
    font-weight: 400;
    font-style: italic;
    letter-spacing: -0.02em;
    line-height: 1.1;
    color: var(--text);
    margin-bottom: 20px;
  }

  .prob-subhead {
    font-size: 15px;
    color: var(--muted);
    line-height: 1.75;
    max-width: 500px;
  }

  .prob-stat-cluster {
    display: flex;
    flex-direction: column;
    gap: 1px;
    background: var(--border);
    border: 1px solid var(--border);
    border-radius: 2px;
    overflow: hidden;
  }

  .prob-big-stat {
    background: var(--surface2);
    padding: 20px 24px;
    transition: background 0.15s;
  }

  .prob-big-stat:hover { background: var(--accent-light); }

  .prob-stat-num {
    font-family: var(--serif);
    font-size: 36px;
    font-style: italic;
    color: var(--danger);
    line-height: 1;
    margin-bottom: 6px;
  }

  .prob-stat-label {
    font-family: var(--mono);
    font-size: 17px;
    color: var(--muted);
    line-height: 1.5;
    letter-spacing: 0.03em;
  }

  .prob-section-label {
    font-family: var(--mono);
    font-size: 17px;
    color: var(--muted-light);
    letter-spacing: 0.2em;
    text-transform: uppercase;
    margin-bottom: 20px;
    padding-bottom: 12px;
    border-bottom: 1px solid var(--border);
  }

  /* Story / timeline */
  .prob-story {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 2px;
    padding: 36px 44px;
    margin-bottom: 8px;
  }

  .prob-story-intro {
    font-size: 15px;
    color: var(--muted);
    font-style: italic;
    margin-bottom: 32px;
    padding-bottom: 24px;
    border-bottom: 1px solid var(--border);
  }

  .prob-timeline {
    display: flex;
    flex-direction: column;
    gap: 0;
    position: relative;
  }

  .prob-timeline::before {
    content: '';
    position: absolute;
    left: 72px;
    top: 0; bottom: 0;
    width: 1px;
    background: var(--border);
  }

  .prob-moment {
    display: grid;
    grid-template-columns: 88px 1fr;
    gap: 28px;
    padding: 24px 0;
    border-bottom: 1px solid var(--border);
    align-items: start;
  }

  .prob-moment-last { border-bottom: none; }

  .prob-time {
    font-family: var(--mono);
    font-size: 13px;
    color: var(--muted-light);
    padding-top: 3px;
    text-align: right;
    padding-right: 20px;
    letter-spacing: 0.05em;
    white-space: nowrap;
  }

  .prob-moment-title {
    font-size: 17px;
    font-weight: 600;
    color: var(--text);
    margin-bottom: 8px;
  }

  .prob-moment-text {
    font-size: 16px;
    color: var(--muted);
    line-height: 1.7;
    margin-bottom: 10px;
  }

  .prob-moment-cost {
    font-family: var(--mono);
    font-size: 12px;
    color: var(--danger);
    background: rgba(184,50,50,0.06);
    border: 1px solid rgba(184,50,50,0.15);
    padding: 5px 10px;
    border-radius: 2px;
    letter-spacing: 0.03em;
    display: inline-block;
  }

  /* Five challenges */
  .prob-challenges {
    display: flex;
    flex-direction: column;
    gap: 1px;
    background: var(--border);
    border: 1px solid var(--border);
    border-radius: 2px;
    overflow: hidden;
    margin-bottom: 8px;
  }

  .prob-challenge {
    display: grid;
    grid-template-columns: 56px 1fr;
    gap: 28px;
    background: var(--surface);
    padding: 28px 32px;
    align-items: start;
    transition: background 0.15s;
  }

  .prob-challenge:hover { background: var(--surface2); }
  .prob-challenge-last { }

  .prob-ch-num {
    font-family: var(--serif);
    font-size: 32px;
    font-style: italic;
    color: var(--danger);
    opacity: 0.4;
    line-height: 1;
    padding-top: 3px;
  }

  .prob-ch-title {
    font-size: 17px;
    font-weight: 600;
    color: var(--text);
    margin-bottom: 10px;
  }

  .prob-ch-text {
    font-size: 16px;
    color: var(--muted);
    line-height: 1.75;
    margin-bottom: 12px;
  }

  .prob-ch-impact {
    font-family: var(--mono);
    font-size: 12px;
    color: var(--warn);
    letter-spacing: 0.06em;
    padding: 5px 10px;
    background: rgba(184,106,26,0.07);
    border: 1px solid rgba(184,106,26,0.18);
    border-radius: 2px;
    display: inline-block;
  }

  /* CTA strip */
  .prob-cta {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 32px;
    background: var(--text);
    border-radius: 2px;
    padding: 36px 44px;
    margin-top: 40px;
    margin-bottom: 48px;
  }

  .prob-cta-title {
    font-family: var(--serif);
    font-size: 26px;
    font-style: italic;
    color: var(--bg);
    margin-bottom: 8px;
  }

  .prob-cta-sub {
    font-family: var(--mono);
    font-size: 17px;
    color: rgba(250,247,242,0.5);
    letter-spacing: 0.1em;
    line-height: 1.8;
  }

  .prob-cta-buttons {
    display: flex;
    gap: 12px;
    flex-shrink: 0;
  }

  .prob-btn-primary {
    font-family: var(--sans);
    font-size: 13px;
    font-weight: 600;
    padding: 12px 24px;
    background: var(--accent);
    color: var(--text);
    border: none;
    border-radius: 2px;
    cursor: pointer;
    letter-spacing: 0.01em;
    transition: opacity 0.15s, transform 0.15s;
    white-space: nowrap;
  }

  .prob-btn-primary:hover { opacity: 0.88; transform: translateY(-1px); }

  .prob-btn-secondary {
    font-family: var(--sans);
    font-size: 13px;
    font-weight: 500;
    padding: 12px 24px;
    background: transparent;
    color: rgba(250,247,242,0.7);
    border: 1px solid rgba(250,247,242,0.2);
    border-radius: 2px;
    cursor: pointer;
    transition: all 0.15s;
    white-space: nowrap;
  }

  .prob-btn-secondary:hover {
    color: var(--bg);
    border-color: rgba(250,247,242,0.5);
  }

  @media (max-width: 900px) {
    .prob-opening { grid-template-columns: 1fr; }
    .prob-cta { flex-direction: column; align-items: flex-start; }
  }

  /* ── Demo status bar ────────────────────────────────────── */
  .demo-status-bar {
    display: flex;
    align-items: center;
    justify-content: space-between;
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 2px;
    padding: 10px 20px;
    margin-bottom: 20px;
    gap: 16px;
  }

  .demo-status-left {
    display: flex;
    align-items: center;
    gap: 10px;
    flex-wrap: wrap;
  }

  .demo-status-item {
    font-family: var(--mono);
    font-size: 16px;
    color: var(--muted);
  }

  .demo-status-item strong {
    color: var(--text2);
  }

  .demo-status-divider {
    font-family: var(--mono);
    font-size: 16px;
    color: var(--border-dark);
  }

  .demo-status-right {
    position: relative;
    flex-shrink: 0;
  }

  .demo-status-explain {
    font-family: var(--mono);
    font-size: 17px;
    color: var(--accent);
    letter-spacing: 0.08em;
    cursor: pointer;
    border-bottom: 1px dashed rgba(196,98,45,0.4);
    padding-bottom: 1px;
  }

  .demo-status-tooltip {
    display: none;
    position: absolute;
    right: 0;
    top: calc(100% + 10px);
    width: 320px;
    background: var(--text);
    color: var(--bg);
    padding: 16px 18px;
    border-radius: 2px;
    font-size: 17px;
    line-height: 1.65;
    z-index: 50;
    box-shadow: 0 8px 32px rgba(26,20,16,0.18);
  }

  .demo-status-tooltip::before {
    content: '';
    position: absolute;
    top: -5px;
    right: 12px;
    width: 10px;
    height: 10px;
    background: var(--text);
    transform: rotate(45deg);
  }

  .demo-status-right:hover .demo-status-tooltip {
    display: block;
  }

  /* ── Discovery page ─────────────────────────────────────── */
  .disc-hero {
    display: grid;
    grid-template-columns: 1fr 340px;
    gap: 40px;
    align-items: start;
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 2px;
    padding: 48px;
    margin-bottom: 40px;
    position: relative;
    overflow: hidden;
  }

  .disc-hero::before {
    content: '';
    position: absolute;
    top: 0; left: 0; right: 0;
    height: 3px;
    background: linear-gradient(90deg, var(--accent2), var(--accent));
  }

  .disc-hero-aside {
    background: var(--surface2);
    border: 1px solid var(--border);
    border-radius: 2px;
    padding: 24px;
  }

  .disc-aside-label {
    font-family: var(--mono);
    font-size: 16px;
    color: var(--accent2);
    letter-spacing: 0.2em;
    text-transform: uppercase;
    margin-bottom: 12px;
  }

  .disc-aside-text {
    font-size: 13px;
    color: var(--muted);
    line-height: 1.7;
  }

  .disc-section-label {
    font-family: var(--mono);
    font-size: 17px;
    color: var(--muted-light);
    letter-spacing: 0.2em;
    text-transform: uppercase;
    margin-bottom: 20px;
    padding-bottom: 12px;
    border-bottom: 1px solid var(--border);
  }

  /* Problem statement */
  .disc-problem-stmt {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 2px;
    overflow: hidden;
  }

  .disc-ps-quote {
    font-family: var(--serif);
    font-size: 20px;
    font-style: italic;
    color: var(--text);
    line-height: 1.55;
    padding: 36px 44px;
    border-bottom: 1px solid var(--border);
    background: rgba(45,110,142,0.03);
  }

  .disc-ps-meta {
    display: grid;
    grid-template-columns: repeat(3,1fr);
    border-top: none;
  }

  .disc-ps-meta-item {
    padding: 20px 24px;
    border-right: 1px solid var(--border);
  }

  .disc-ps-meta-item:last-child { border-right: none; }

  .disc-ps-meta-label {
    font-family: var(--mono);
    font-size: 16px;
    color: var(--muted-light);
    letter-spacing: 0.15em;
    text-transform: uppercase;
    margin-bottom: 8px;
  }

  .disc-ps-meta-val {
    font-size: 13px;
    color: var(--muted);
    line-height: 1.6;
  }

  /* Interview cards */
  .disc-interviews {
    display: grid;
    grid-template-columns: repeat(2,1fr);
    gap: 12px;
    margin-bottom: 8px;
  }

  .disc-interview {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 2px;
    padding: 28px;
    transition: box-shadow 0.2s;
  }

  .disc-interview:hover {
    box-shadow: 0 4px 20px rgba(26,20,16,0.07);
  }

  .disc-int-role {
    font-size: 15px;
    font-weight: 600;
    color: var(--text);
    margin-bottom: 3px;
  }

  .disc-int-co {
    font-family: var(--mono);
    font-size: 17px;
    color: var(--accent);
    letter-spacing: 0.08em;
    margin-bottom: 14px;
    padding-bottom: 14px;
    border-bottom: 1px solid var(--border);
  }

  .disc-int-why {
    font-size: 13px;
    color: var(--muted);
    line-height: 1.65;
    margin-bottom: 16px;
  }

  .disc-int-qs-label {
    font-family: var(--mono);
    font-size: 16px;
    color: var(--muted-light);
    letter-spacing: 0.15em;
    text-transform: uppercase;
    margin-bottom: 10px;
  }

  .disc-int-qlist {
    list-style: none;
    padding: 0;
    display: flex;
    flex-direction: column;
    gap: 8px;
  }

  .disc-int-qlist li {
    font-size: 13px;
    color: var(--text2);
    line-height: 1.55;
    padding-left: 16px;
    position: relative;
  }

  .disc-int-qlist li::before {
    content: '→';
    position: absolute;
    left: 0;
    color: var(--accent2);
    font-family: var(--mono);
    font-size: 17px;
    top: 2px;
  }

  /* Hypothesis */
  .disc-hypothesis {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 2px;
    overflow: hidden;
    margin-bottom: 8px;
  }

  .disc-hyp-main {
    padding: 36px 44px;
    background: rgba(45,110,142,0.03);
    border-bottom: 1px solid var(--border);
  }

  .disc-hyp-label {
    font-family: var(--mono);
    font-size: 16px;
    color: var(--accent2);
    letter-spacing: 0.2em;
    margin-bottom: 14px;
  }

  .disc-hyp-statement {
    font-family: var(--serif);
    font-size: 19px;
    font-style: italic;
    color: var(--text);
    line-height: 1.6;
  }

  .disc-hyp-tests {
    display: grid;
    grid-template-columns: 1fr 1fr;
  }

  .disc-hyp-test {
    padding: 24px 32px;
    border-right: 1px solid var(--border);
  }

  .disc-hyp-test:last-child { border-right: none; }

  .disc-hyp-test-label {
    font-family: var(--mono);
    font-size: 16px;
    letter-spacing: 0.15em;
    text-transform: uppercase;
    margin-bottom: 10px;
  }

  .disc-hyp-test:first-child .disc-hyp-test-label { color: var(--ok); }
  .disc-hyp-test:last-child .disc-hyp-test-label { color: var(--danger); }

  .disc-hyp-test-val {
    font-size: 13px;
    color: var(--muted);
    line-height: 1.65;
  }

  /* Success metrics */
  .disc-metrics {
    display: flex;
    flex-direction: column;
    gap: 1px;
    background: var(--border);
    border: 1px solid var(--border);
    border-radius: 2px;
    overflow: hidden;
    margin-bottom: 8px;
  }

  .disc-metric {
    display: flex;
    gap: 24px;
    align-items: flex-start;
    background: var(--surface);
    padding: 24px 28px;
    transition: background 0.15s;
  }

  .disc-metric:hover { background: var(--surface2); }

  .disc-metric-icon {
    font-size: 22px;
    flex-shrink: 0;
    width: 40px;
    text-align: center;
    margin-top: 2px;
  }

  .disc-metric-name {
    font-size: 15px;
    font-weight: 600;
    color: var(--text);
    margin-bottom: 6px;
  }

  .disc-metric-desc {
    font-size: 13px;
    color: var(--muted);
    line-height: 1.65;
  }

  /* Open questions */
  .disc-openqs {
    display: flex;
    flex-direction: column;
    gap: 1px;
    background: var(--border);
    border: 1px solid var(--border);
    border-radius: 2px;
    overflow: hidden;
    margin-bottom: 8px;
  }

  .disc-oq {
    display: grid;
    grid-template-columns: 48px 1fr;
    gap: 24px;
    background: var(--surface);
    padding: 24px 28px;
    align-items: start;
    transition: background 0.15s;
  }

  .disc-oq:hover { background: var(--surface2); }

  .disc-oq-num {
    font-family: var(--serif);
    font-size: 36px;
    font-style: italic;
    color: var(--accent2);
    opacity: 0.5;
    line-height: 1;
    padding-top: 2px;
    text-align: center;
  }

  .disc-oq-title {
    font-size: 15px;
    font-weight: 600;
    color: var(--text);
    margin-bottom: 8px;
  }

  .disc-oq-text {
    font-size: 13px;
    color: var(--muted);
    line-height: 1.7;
  }

  @media (max-width: 900px) {
    .disc-hero { grid-template-columns: 1fr; }
    .disc-interviews { grid-template-columns: 1fr; }
    .disc-hyp-tests { grid-template-columns: 1fr; }
    .disc-ps-meta { grid-template-columns: 1fr; }
  }

  /* ── Problem / Solution Banner ─────────────────────────── */
  .ps-banner {
    display: grid;
    grid-template-columns: 1fr 60px 1fr;
    border: 1px solid var(--border);
    border-radius: 2px;
    overflow: hidden;
    margin-bottom: 40px;
  }

  .ps-half {
    padding: 40px 44px;
  }

  .ps-problem {
    background: rgba(184,50,50,0.04);
    border-right: 1px solid var(--border);
  }

  .ps-solution {
    background: rgba(45,125,82,0.04);
  }

  .ps-label {
    font-family: var(--mono);
    font-size: 16px;
    color: var(--danger);
    letter-spacing: 0.2em;
    text-transform: uppercase;
    margin-bottom: 12px;
  }

  .ps-title {
    font-family: var(--serif);
    font-size: 26px;
    font-style: italic;
    color: var(--text);
    margin-bottom: 18px;
    line-height: 1.2;
  }

  .ps-body {
    font-size: 15px;
    color: var(--muted);
    line-height: 1.8;
  }

  .ps-divider {
    display: flex;
    align-items: center;
    justify-content: center;
    background: var(--surface2);
    border-left: 1px solid var(--border);
    border-right: 1px solid var(--border);
  }

  .ps-divider-icon {
    font-size: 22px;
    color: var(--accent);
    font-family: var(--mono);
  }

</style>
</head>
<body>
<div class="container">

  <!-- Header -->
  <header>
    <div class="header-inner">
      <div class="logo">
        <div class="logo-wordmark">
          <h1>SquareFlow</h1>
        </div>
        <div class="logo-divider"></div>
        <div class="logo-sub">Square for Enterprise · Product Concept</div>
      </div>
      <div style="display:flex;align-items:center;gap:28px;">
        <nav class="header-nav">
          <button class="nav-btn active" id="nav-problem" onclick="showPage('problem')">About</button>
          <button class="nav-btn" id="nav-discovery" onclick="showPage('discovery')">Discovery</button>
          <button class="nav-btn" id="nav-flowchart" onclick="showPage('flowchart')">Integration</button>
          <button class="nav-btn" id="nav-summary" onclick="showPage('summary')">Metrics</button>
          <button class="nav-btn" id="nav-dashboard" onclick="showPage('dashboard')">Demo</button>
        </nav>
      </div>
    </div>
  </header>

  <!-- PAGE: THE PROBLEM -->
  <div id="page-problem" class="page">

    <!-- Opening hook -->
    <div class="prob-opening">
      <div class="prob-opening-text">
        <div class="summary-eyebrow">Why SquareFlow Exists</div>
        <h2 class="prob-headline">Your shelves know things<br>your checkout system doesn't.</h2>
        <p class="prob-subhead">Every day, retail stores lose sales not because the product is gone — but because no one could tell the difference between "sold out" and "sitting in the back room." That gap is the problem. SquareFlow is the fix.</p>
      </div>
      <div class="prob-stat-cluster">
        <div class="prob-big-stat">
          <div class="prob-stat-num">~2%</div>
          <div class="prob-stat-label">of retail revenue lost annually to inventory inaccuracy</div>
        </div>
        <div class="prob-big-stat">
          <div class="prob-stat-num">65%</div>
          <div class="prob-stat-label">of inventory records are inaccurate in a typical retail store</div>
        </div>
        <div class="prob-big-stat">
          <div class="prob-stat-num">$1.1T</div>
          <div class="prob-stat-label">in global retail sales lost to out-of-stocks each year</div>
        </div>
      </div>
    </div>

    <!-- Story section -->
    <div class="prob-section-label">A Day in the Life</div>
    <div class="prob-story">
      <div class="prob-story-intro">Meet Jordan, a store manager at a mid-size apparel chain. This is a normal Tuesday.</div>
      <div class="prob-timeline">

        <div class="prob-moment">
          <div class="prob-time">8:14 AM</div>
          <div class="prob-moment-body">
            <div class="prob-moment-title">A customer calls ahead</div>
            <div class="prob-moment-text">She wants to know if the black leggings in size small are in stock before she makes the 20-minute drive. Jordan checks Square. It says 2 units. She tells the customer yes, come on in.</div>
          </div>
        </div>

        <div class="prob-moment">
          <div class="prob-time">9:02 AM</div>
          <div class="prob-moment-body">
            <div class="prob-moment-title">The customer arrives</div>
            <div class="prob-moment-text">Jordan searches the floor. Nothing. Checks the stockroom. Nothing. Square says 2 — but those 2 units were returned last week and never properly re-tagged. The customer leaves empty-handed and frustrated.</div>
            <div class="prob-moment-cost">Lost sale. Lost trust. 40-minute round trip wasted.</div>
          </div>
        </div>

        <div class="prob-moment">
          <div class="prob-time">11:30 AM</div>
          <div class="prob-moment-body">
            <div class="prob-moment-title">The blue denim jacket runs out</div>
            <div class="prob-moment-text">Three sold in two hours — a fast day. Square now shows 0. But Jordan doesn't find out until a customer asks and an associate checks. By then it's been empty for 45 minutes. No alert was sent. No reorder was triggered.</div>
            <div class="prob-moment-cost">45 minutes of zero sales on a top-performing SKU.</div>
          </div>
        </div>

        <div class="prob-moment">
          <div class="prob-time">2:45 PM</div>
          <div class="prob-moment-body">
            <div class="prob-moment-title">Corporate asks for a stock report</div>
            <div class="prob-moment-text">Jordan pulls the numbers from Square. They look fine on paper. But three SKUs that show stock haven't been physically verified in four days. One of them was almost certainly shoplifted — but without a real count, no one can tell.</div>
            <div class="prob-moment-cost">Decisions made on data nobody trusts.</div>
          </div>
        </div>

        <div class="prob-moment prob-moment-last">
          <div class="prob-time">5:00 PM</div>
          <div class="prob-moment-body">
            <div class="prob-moment-title">Jordan does a manual count</div>
            <div class="prob-moment-text">Like every Tuesday. One associate walks the floor for 90 minutes with a clipboard. The numbers get entered into a spreadsheet. Then someone manually updates Square. By the time it's done, it's already a little out of date.</div>
            <div class="prob-moment-cost">90 minutes of labor. Data that's stale before it's entered.</div>
          </div>
        </div>

      </div>
    </div>

    <!-- The 5 opportunities -->
    <div class="prob-section-label" style="margin-top:48px;">Five Enterprise Retail Needs — And What Native RFID Integration Could Unlock</div>
    <div class="prob-challenges">

      <div class="prob-challenge">
        <div class="prob-ch-num">01</div>
        <div class="prob-ch-body">
          <div class="prob-ch-title">Enterprise retailers need item-level visibility — not just product totals.</div>
          <div class="prob-ch-text">At small scale, knowing you have "3 blue jackets" is enough. At 100+ stores, operators need to know which 3 jackets they are, where exactly each one is, and whether it's actually sellable. An RFID-native mode within Square — one that surfaces individual item status alongside existing SKU counts — would give enterprise retailers the granularity they need to verify returns, investigate shrinkage, and confirm curbside availability with confidence.</div>
          <div class="prob-ch-impact">Opportunity: Item-level mode for enterprise plans · Shrinkage investigation · Verified BOPIS</div>
        </div>
      </div>

      <div class="prob-challenge">
        <div class="prob-ch-num">02</div>
        <div class="prob-ch-body">
          <div class="prob-ch-title">A continuous sync layer would give Square operators a self-correcting inventory floor.</div>
          <div class="prob-ch-text">Right now, Square inventory drifts between manual audits — quietly accumulating errors from shoplifting, receiving mistakes, and misprocessed returns. Integrating RFID as a continuous sync source would make Square's counts self-correcting: every scan cycle closes the gap automatically, without anyone touching a clipboard. Accuracy becomes a system property, not a labor cost.</div>
          <div class="prob-ch-impact">Opportunity: Continuous accuracy · Reduced audit labor · Trustworthy reorder signals</div>
        </div>
      </div>

      <div class="prob-challenge">
        <div class="prob-ch-num">03</div>
        <div class="prob-ch-body">
          <div class="prob-ch-title">Zone-aware inventory would unlock reliable BOPIS and ship-from-store at scale.</div>
          <div class="prob-ch-text">Square currently has no concept of where within a store an item lives. Adding zone-awareness — floor vs. stockroom, front-of-house vs. receiving — would let Square tell customers not just "in stock" but "available now." For buy-online-pickup-in-store and same-day ship-from-store, that distinction is the difference between a fulfilled order and a disappointed customer who drove across town.</div>
          <div class="prob-ch-impact">Opportunity: Real-time BOPIS accuracy · Ship-from-store confidence · Fewer failed pickups</div>
        </div>
      </div>

      <div class="prob-challenge">
        <div class="prob-ch-num">04</div>
        <div class="prob-ch-body">
          <div class="prob-ch-title">Cross-location intelligence built into Square would make multi-store operations seamless.</div>
          <div class="prob-ch-text">Today, each Square location is effectively its own island. A retailer running 50 stores has to manually reconcile stock across locations to answer simple questions — "which store has excess?" or "where should I transfer from?" Native cross-location inventory intelligence would surface these answers automatically, enabling smarter transfers, unified "find it nearby" features on retailer websites, and fleet-wide visibility from a single dashboard.</div>
          <div class="prob-ch-impact">Opportunity: Transfer recommendations · "Available nearby" feature · Fleet-wide dashboard</div>
        </div>
      </div>

      <div class="prob-challenge prob-challenge-last">
        <div class="prob-ch-num">05</div>
        <div class="prob-ch-body">
          <div class="prob-ch-title">A predictive layer would shift Square from a recording tool to a decision-support tool.</div>
          <div class="prob-ch-text">Square records what has happened. What enterprise retailers need is a system that tells them what's about to happen — and what to do about it. By combining RFID velocity data with lead times and historical sell patterns, Square could proactively surface reorder recommendations, flag stockout risk before a shelf goes empty, and help operators make restocking decisions hours or days ahead of the problem. This prototype models exactly that capability.</div>
          <div class="prob-ch-impact">Opportunity: Predictive restocking · Proactive risk alerts · AI-assisted decisions</div>
        </div>
      </div>

    </div>

    <!-- CTA to see the solution -->
    <div class="prob-cta">
      <div class="prob-cta-text">
        <div class="prob-cta-title">This prototype models all five opportunities.</div>
        <div class="prob-cta-sub">Real-time RFID sync · AI-powered stockout prediction · Cross-location visibility · Zero manual counting</div>
      </div>
      <div class="prob-cta-buttons">
        <button class="prob-btn-primary" onclick="showPage('discovery')">See My Process →</button>
        <button class="prob-btn-secondary" onclick="showPage('dashboard')">View Live Demo</button>
      </div>
    </div>

  </div> <!-- /page-problem -->

  <!-- PAGE: DISCOVERY -->
  <div id="page-discovery" class="page" style="display:none;">

    <!-- Hero -->
    <div class="disc-hero">
      <div>
        <div class="summary-eyebrow">Product Thinking</div>
        <h2 class="summary-title">From Observation to Hypothesis</h2>
        <p class="summary-desc">This prototype began with a question, not a solution. The flowchart, risk engine, and demo that follow are artifacts of a product discovery process — not the process itself. Here's how I'd actually think about this problem before writing a single line of code.</p>
      </div>
      <div class="disc-hero-aside">
        <div class="disc-aside-label">A NOTE ON THIS PROJECT</div>
        <div class="disc-aside-text">SquareFlow is a concept prototype built to stress-test a hypothesis about Square's enterprise retail gap. The technical implementation exists to make the thinking tangible — not to propose a finished product. Every section below represents what I would do before building anything.</div>
      </div>
    </div>

    <!-- Problem Statement -->
    <div class="disc-section-label">The Problem Statement</div>
    <div class="disc-problem-stmt">
      <div class="disc-ps-quote">
        "Multi-location retailers using Square as their POS have no reliable mechanism to keep inventory counts accurate at scale — leading to lost sales, broken customer promises, and reactive rather than proactive restocking decisions."
      </div>
      <div class="disc-ps-meta">
        <div class="disc-ps-meta-item">
          <div class="disc-ps-meta-label">Who feels this pain</div>
          <div class="disc-ps-meta-val">Store operators running 10–200 locations on Square who've outgrown manual count cycles</div>
        </div>
        <div class="disc-ps-meta-item">
          <div class="disc-ps-meta-label">When it surfaces</div>
          <div class="disc-ps-meta-val">At the moment a customer asks for something the system says is in stock — and it isn't</div>
        </div>
        <div class="disc-ps-meta-item">
          <div class="disc-ps-meta-label">Why it persists</div>
          <div class="disc-ps-meta-val">Square was built for simplicity at small scale; RFID systems speak a different language; no middleware connects them</div>
        </div>
      </div>
    </div>

    <!-- Who I'd talk to -->
    <div class="disc-section-label" style="margin-top:48px;">Who I'd Talk To First</div>
    <div class="disc-interviews">

      <div class="disc-interview">
        <div class="disc-int-role">Store Operations Manager</div>
        <div class="disc-int-co">Mid-size apparel chain · 15–40 locations</div>
        <div class="disc-int-why">Closest to the daily pain. Would know exactly how often inventory counts are wrong, how staff currently cope, and what a "good enough" solution looks like in practice.</div>
        <div class="disc-int-qs">
          <div class="disc-int-qs-label">Key questions</div>
          <ul class="disc-int-qlist">
            <li>Walk me through the last time a customer was disappointed because of a stock discrepancy. What happened?</li>
            <li>How often do you manually recount inventory today, and what triggers it?</li>
            <li>If you could fix one inventory problem tomorrow, what would it be — accuracy, speed, or visibility across stores?</li>
          </ul>
        </div>
      </div>

      <div class="disc-interview">
        <div class="disc-int-role">VP of Retail Technology</div>
        <div class="disc-int-co">Enterprise apparel brand · 100–500 locations</div>
        <div class="disc-int-why">Would have already evaluated RFID vendors and have opinions on what integration gaps exist. Understands the build-vs-buy tradeoff and what would need to be true for a middleware solution to win their business.</div>
        <div class="disc-int-qs">
          <div class="disc-int-qs-label">Key questions</div>
          <ul class="disc-int-qlist">
            <li>You've likely looked at RFID before — what stopped you from going further, or what made you proceed?</li>
            <li>What does your current Square integration look like, and where does it break down?</li>
            <li>Would you pay for a sync layer, or does this need to be native to the POS to be worth adopting?</li>
          </ul>
        </div>
      </div>

      <div class="disc-interview">
        <div class="disc-int-role">Square Mid-Market Account Manager</div>
        <div class="disc-int-co">Square internal · manages 20–100 location accounts</div>
        <div class="disc-int-why">Hears the objections that cause enterprise retailers to churn or not upgrade. Would know which inventory-related complaints come up most in renewal conversations and whether Square has already tried to address this internally.</div>
        <div class="disc-int-qs">
          <div class="disc-int-qs-label">Key questions</div>
          <ul class="disc-int-qlist">
            <li>What are the top reasons multi-location retailers tell you they're considering switching away from Square?</li>
            <li>Has inventory accuracy ever come up as a blocker for an enterprise deal?</li>
            <li>Is there an internal team already working on this, or is it considered out of scope?</li>
          </ul>
        </div>
      </div>

      <div class="disc-interview">
        <div class="disc-int-role">RFID Implementation Consultant</div>
        <div class="disc-int-co">Third-party integrator · retail vertical</div>
        <div class="disc-int-why">Would know which retailers are actively looking for Square-compatible RFID workflows and what the most common integration failure points are. A potential distribution channel or technical partner.</div>
        <div class="disc-int-qs">
          <div class="disc-int-qs-label">Key questions</div>
          <ul class="disc-int-qlist">
            <li>Which POS systems do your retail clients most commonly need you to integrate with?</li>
            <li>What's the hardest part of syncing RFID data with a checkout system?</li>
            <li>Have any clients specifically asked about Square compatibility?</li>
          </ul>
        </div>
      </div>

    </div>

    <!-- Hypothesis -->
    <div class="disc-section-label" style="margin-top:48px;">My Hypothesis</div>
    <div class="disc-hypothesis">
      <div class="disc-hyp-main">
        <div class="disc-hyp-label">I BELIEVE THAT</div>
        <div class="disc-hyp-statement">Inventory sync accuracy is a higher-priority pain than predictive restocking for Square operators in the 10–50 store range — because the baseline problem of stale and inaccurate counts needs to be solved before AI-driven recommendations have any credibility with store teams.</div>
      </div>
      <div class="disc-hyp-tests">
        <div class="disc-hyp-test">
          <div class="disc-hyp-test-label">This would be proven TRUE if</div>
          <div class="disc-hyp-test-val">Operators consistently rank "counts I can trust" above "alerts about what to reorder" in a priority exercise, and cite manual reconciliation as a regular time cost.</div>
        </div>
        <div class="disc-hyp-test">
          <div class="disc-hyp-test-label">This would be proven FALSE if</div>
          <div class="disc-hyp-test-val">Operators say their current counts are "good enough" and the real pain is not knowing when to reorder — suggesting the AI layer is the actual product, and sync is just plumbing.</div>
        </div>
      </div>
    </div>

    <!-- Success Metrics -->
    <div class="disc-section-label" style="margin-top:48px;">How I'd Measure Success</div>
    <div class="disc-metrics">
      <div class="disc-metric">
        <div class="disc-metric-icon">📉</div>
        <div class="disc-metric-body">
          <div class="disc-metric-name">Reduction in inventory discrepancy rate</div>
          <div class="disc-metric-desc">The gap between what Square shows and what a physical count finds. Baseline this before launch, track weekly. Target: below 3% within 60 days of RFID sync going live.</div>
        </div>
      </div>
      <div class="disc-metric">
        <div class="disc-metric-icon">✅</div>
        <div class="disc-metric-body">
          <div class="disc-metric-name">BOPIS fulfillment success rate</div>
          <div class="disc-metric-desc">% of buy-online-pickup-in-store orders fulfilled without a "sorry, we don't actually have it" conversation. A direct signal that website inventory reflects reality.</div>
        </div>
      </div>
      <div class="disc-metric">
        <div class="disc-metric-icon">⏱</div>
        <div class="disc-metric-body">
          <div class="disc-metric-name">Associate time spent on manual counts</div>
          <div class="disc-metric-desc">Hours per week per store dedicated to clipboard-based inventory reconciliation. Should trend toward zero as RFID scan cycles replace manual processes.</div>
        </div>
      </div>
      <div class="disc-metric">
        <div class="disc-metric-icon">🔔</div>
        <div class="disc-metric-body">
          <div class="disc-metric-name">Stockout alert action rate</div>
          <div class="disc-metric-desc">% of AI-generated reorder alerts that result in a reorder within 24 hours. Measures whether the risk scores are trusted and actionable — not just noise.</div>
        </div>
      </div>
    </div>

    <!-- Open Questions -->
    <div class="disc-section-label" style="margin-top:48px;">What I Don't Know Yet</div>
    <div class="disc-openqs">
      <div class="disc-oq">
        <div class="disc-oq-num">?</div>
        <div class="disc-oq-body">
          <div class="disc-oq-title">Would Square build this natively, or partner for it?</div>
          <div class="disc-oq-text">The middleware approach only makes sense as an external product if Square has no roadmap plans to close this gap internally. If Square is already building an RFID integration layer, the opportunity is to influence its design — not build a competing product. I don't know the answer to this without insider visibility.</div>
        </div>
      </div>
      <div class="disc-oq">
        <div class="disc-oq-num">?</div>
        <div class="disc-oq-body">
          <div class="disc-oq-title">Is the pain acute enough to justify an integration project?</div>
          <div class="disc-oq-text">Deploying RFID + middleware requires upfront investment in tagging infrastructure, staff training, and IT setup. For many 10–50 store operators, the ROI math might not work yet. The right question isn't "does this solve a real problem?" but "is the problem painful enough that operators will invest in solving it right now?"</div>
        </div>
      </div>
      <div class="disc-oq">
        <div class="disc-oq-num">?</div>
        <div class="disc-oq-body">
          <div class="disc-oq-title">Who owns the buying decision — operations or IT?</div>
          <div class="disc-oq-text">If the store operations team feels the pain but the IT team controls the budget and vendor decisions, the sales motion is completely different. This affects everything from how the product is packaged to what the pricing model looks like. I'd want to map the decision-making unit before defining a go-to-market approach.</div>
        </div>
      </div>
      <div class="disc-oq">
        <div class="disc-oq-num">?</div>
        <div class="disc-oq-body">
          <div class="disc-oq-title">Does the AI layer add value before the data is clean?</div>
          <div class="disc-oq-text">The risk engine in this prototype assumes that RFID scan data is reliable. But if a retailer is just starting with RFID, their historical velocity data is sparse and their scan discipline is inconsistent. The AI scores might be wrong or untrustworthy for the first several months — which could undermine adoption of the whole system if it gets associated with bad recommendations early.</div>
        </div>
      </div>
    </div>

    <!-- CTA -->
    <div class="prob-cta" style="margin-top:48px;">
      <div class="prob-cta-text">
        <div class="prob-cta-title">The prototype makes the thinking visible.</div>
        <div class="prob-cta-sub">Integration Flowchart · Metrics Model · Live Risk Scoring Demo</div>
      </div>
      <div class="prob-cta-buttons">
        <button class="prob-btn-primary" onclick="showPage('flowchart')">See the Architecture →</button>
        <button class="prob-btn-secondary" onclick="showPage('dashboard')">View Live Demo</button>
      </div>
    </div>

  </div> <!-- /page-discovery -->

  <!-- PAGE: DASHBOARD -->
  <div id="page-dashboard" class="page" style="display:none;">

  <!-- Demo status bar -->
  <div class="demo-status-bar">
    <div class="demo-status-left">
      <span class="live-dot"></span>
      <span class="demo-status-item"><strong>MODEL ACTIVE</strong> — 847ms last inference</span>
      <span class="demo-status-divider">·</span>
      <span class="demo-status-item">Store: Flagship Michigan Ave</span>
      <span class="demo-status-divider">·</span>
      <span class="demo-status-item">Scan: 09:15 UTC</span>
      <span class="demo-status-divider">·</span>
      <span class="demo-status-item">30 EPCs processed</span>
    </div>
    <div class="demo-status-right">
      <span class="demo-status-explain">What does this mean?</span>
      <div class="demo-status-tooltip">
        <p><strong>MODEL ACTIVE / 847ms</strong> — The AI risk engine is running. Every time a new scan comes in, it re-scores all SKUs. 847ms is how long the last scoring run took.</p>
        <p style="margin-top:8px;"><strong>Store / Scan / EPCs</strong> — Shows which store you're viewing, when the last RFID floor scan happened, and how many individual tagged items were detected (30 in this demo).</p>
      </div>
    </div>
  </div>

  <!-- Stats bar -->
  <div class="stats-bar">
    <div class="stat">
      <div class="stat-label">Critical Risk SKUs</div>
      <div class="stat-value danger" id="stat-critical">3</div>
      <div class="stat-sub">≥80% stockout probability</div>
    </div>
    <div class="stat">
      <div class="stat-label">Elevated Risk SKUs</div>
      <div class="stat-value warn" id="stat-elevated">4</div>
      <div class="stat-sub">40–79% stockout probability</div>
    </div>
    <div class="stat">
      <div class="stat-label">Healthy SKUs</div>
      <div class="stat-value ok" id="stat-healthy">7</div>
      <div class="stat-sub">&lt;40% stockout probability</div>
    </div>
    <div class="stat">
      <div class="stat-label">Avg. Hours to Stockout</div>
      <div class="stat-value accent" id="stat-hours">18.4h</div>
      <div class="stat-sub">across critical SKUs</div>
    </div>
  </div>

  <!-- Main grid -->
  <div class="main-grid">

    <!-- Left: SKU table -->
    <div class="panel">
      <div class="panel-header">
        <div class="panel-title"><span>SKU Risk</span> · Stockout Probability Engine</div>
        <span class="panel-badge badge-accent">AI-SCORED</span>
      </div>

      <div class="sku-table">
        <div class="sku-row header-row">
          <div>Product</div>
          <div>Stock</div>
          <div>Velocity</div>
          <div>Risk Score</div>
          <div>Action</div>
        </div>
        <!-- rows injected by JS -->
        <div id="sku-rows"></div>
      </div>

      <div class="model-note">
        ↑ Risk score = weighted model combining sell velocity (0.45), current stock (0.35), and lead time (0.20) · Click any row to inspect AI reasoning
      </div>
    </div>

    <!-- Right: Detail panel -->
    <div class="panel detail-panel" id="detail-panel">
      <div class="panel-header">
        <div class="panel-title"><span>AI</span> · Risk Inspection</div>
        <span class="panel-badge badge-accent" id="detail-badge">SELECT ROW</span>
      </div>

      <div class="detail-content" id="detail-content">
        <div class="detail-empty">
          <div class="arrow">←</div>
          <div>Select a SKU to inspect<br>the model's reasoning</div>
        </div>
      </div>
    </div>
  </div>

  <!-- Simulator -->
  <div class="simulator">
    <div class="sim-header">
      <div class="sim-icon">⚡</div>
      <div>
        <div class="sim-title">What-If Simulator</div>
        <div class="sim-sub">Adjust signals below — risk scores update live across all SKUs</div>
      </div>
    </div>
    <div class="sim-grid">
      <div class="sim-control">
        <label>Sales Velocity Multiplier</label>
        <input type="range" id="sim-velocity" min="0.5" max="3" step="0.1" value="1">
        <div class="val" id="sim-velocity-val">1.0× baseline</div>
      </div>
      <div class="sim-control">
        <label>Replenishment Lead Time (hrs)</label>
        <input type="range" id="sim-lead" min="4" max="72" step="2" value="24">
        <div class="val" id="sim-lead-val">24 hrs</div>
      </div>
      <div class="sim-control">
        <label>Safety Stock Buffer</label>
        <input type="range" id="sim-buffer" min="0" max="5" step="1" value="1">
        <div class="val" id="sim-buffer-val">1 unit</div>
      </div>
    </div>
  </div>

  </div> <!-- /page-dashboard -->

  <!-- PAGE: METRICS SUMMARY -->
  <div id="page-summary" class="page" style="display:none;">

    <div class="summary-hero">
      <div class="summary-hero-text">
        <div class="summary-eyebrow">Model Reference</div>
        <h2 class="summary-title">How SquareFlow Scores Risk</h2>
        <p class="summary-desc">The stockout risk engine combines three real-time signals into a single 0–100 score per SKU. This page explains each signal, its weight in the model, and how the simulator controls affect the output.</p>
      </div>
      <div class="summary-formula">
        <div class="formula-label">RISK SCORE FORMULA</div>
        <div class="formula-body">
          <span class="formula-term v">velocity <span class="fw">×0.45</span></span>
          <span class="formula-op">+</span>
          <span class="formula-term s">depletion <span class="fw">×0.35</span></span>
          <span class="formula-op">+</span>
          <span class="formula-term l">lead time <span class="fw">×0.20</span></span>
          <span class="formula-op">=</span>
          <span class="formula-result">0–100</span>
        </div>
      </div>
    </div>

    <div class="summary-section-label">Simulator Controls</div>
    <div class="summary-cards">

      <div class="scard">
        <div class="scard-icon" style="background:rgba(196,98,45,0.1);color:var(--accent);">⚡</div>
        <div class="scard-body">
          <div class="scard-title">Sales Velocity Multiplier</div>
          <div class="scard-range">Range: 0.5× — 3.0× &nbsp;·&nbsp; Default: 1.0×</div>
          <div class="scard-desc">Scales every SKU's baseline sell rate up or down. A 2× value simulates a weekend rush or promotional event; 0.5× simulates a slow weekday. Because velocity carries the highest model weight (45%), this control has the largest single effect on risk scores — a small increase can push borderline SKUs from Elevated into Critical.</div>
          <div class="scard-formula">
            <span class="sf-label">Effective velocity</span>
            <span class="sf-eq">= baseVelocity × dayOfWeekFactor × <strong>multiplier</strong></span>
          </div>
        </div>
      </div>

      <div class="scard">
        <div class="scard-icon" style="background:rgba(45,110,142,0.1);color:var(--accent2);">🕐</div>
        <div class="scard-body">
          <div class="scard-title">Replenishment Lead Time</div>
          <div class="scard-range">Range: 4 hrs — 72 hrs &nbsp;·&nbsp; Default: 24 hrs</div>
          <div class="scard-desc">How long it takes for new stock to arrive after an order is placed — accounting for supplier processing, shipping, and receiving. If a SKU has only 10 hours of stock remaining and the lead time is 24 hours, it will stockout before replenishment arrives. The model uses this as a pressure signal: the closer lead time is to hours-of-stock-remaining, the higher the score.</div>
          <div class="scard-formula">
            <span class="sf-label">Lead pressure signal</span>
            <span class="sf-eq">= min(1, <strong>leadTime</strong> ÷ hoursOfStock)</span>
          </div>
        </div>
      </div>

      <div class="scard">
        <div class="scard-icon" style="background:rgba(45,125,82,0.1);color:var(--ok);">🛡</div>
        <div class="scard-body">
          <div class="scard-title">Safety Stock Buffer</div>
          <div class="scard-range">Range: 0 units — 5 units &nbsp;·&nbsp; Default: 1 unit</div>
          <div class="scard-desc">A reserved floor of inventory that the model treats as unavailable, to protect against scan inaccuracy, misplaced items, or unexpected demand spikes. When buffer is 1, a SKU showing 3 units is treated as having only 2 effective units. Increasing the buffer makes the model more conservative. Setting it to 0 means every visible unit is counted.</div>
          <div class="scard-formula">
            <span class="sf-label">Effective stock</span>
            <span class="sf-eq">= max(0, currentStock − <strong>safetyBuffer</strong>)</span>
          </div>
        </div>
      </div>

    </div>

    <div class="summary-section-label" style="margin-top:48px;">Model Signals</div>
    <div class="summary-signals">

      <div class="signal-explain">
        <div class="se-header">
          <div class="se-weight" style="background:rgba(196,98,45,0.1);color:var(--accent);">45%</div>
          <div>
            <div class="se-title">Velocity Signal</div>
            <div class="se-sub">How fast is this SKU burning?</div>
          </div>
        </div>
        <div class="se-desc">Measures the ratio of replenishment lead time to hours-of-stock-remaining. A score of 100% means the SKU will run out in exactly the same time it takes to reorder — a worst-case scenario. Scores above 100% are capped at 1.0 before weighting.</div>
        <div class="se-example"><span class="se-ex-label">Example</span> SKU has 3 units, sells at 1.8/day → 40h of stock. Lead time is 24h. Signal = 24÷40 = <strong>60%</strong></div>
      </div>

      <div class="signal-explain">
        <div class="se-header">
          <div class="se-weight" style="background:rgba(184,106,26,0.1);color:var(--warn);">35%</div>
          <div>
            <div class="se-title">Stock Depletion Signal</div>
            <div class="se-sub">How depleted vs. historical average?</div>
          </div>
        </div>
        <div class="se-desc">Compares current stock to the SKU's historical average for this time of week. A SKU that normally has 5 units on Friday afternoon but currently shows 1 is flagged heavily — even if 1 unit alone wouldn't seem alarming. This gives the model memory of what "normal" looks like per SKU.</div>
        <div class="se-example"><span class="se-ex-label">Example</span> Current stock: 1. Historical avg: 4.2. Signal = 1 − (1÷4.2) = <strong>76%</strong></div>
      </div>

      <div class="signal-explain">
        <div class="se-header">
          <div class="se-weight" style="background:rgba(184,50,50,0.1);color:var(--danger);">20%</div>
          <div>
            <div class="se-title">Lead Time Pressure</div>
            <div class="se-sub">Would replenishment arrive in time?</div>
          </div>
        </div>
        <div class="se-desc">A direct comparison: if stock runs out in X hours and replenishment takes Y hours, would the order arrive before the shelf empties? When Y &gt; X, this signal maxes out at 1.0. Carries the lowest weight because velocity and depletion are usually sufficient — lead time acts as the tiebreaker for borderline cases.</div>
        <div class="se-example"><span class="se-ex-label">Example</span> Hours of stock: 18h. Lead time: 24h. Signal = min(1, 24÷18) = <strong>100%</strong> (capped)</div>
      </div>

    </div>

    <div class="summary-section-label" style="margin-top:48px;">Risk Thresholds &amp; Actions</div>
    <div class="threshold-table">
      <div class="tt-row tt-header">
        <div>Score</div>
        <div>Classification</div>
        <div>Meaning</div>
        <div>Recommended Action</div>
      </div>
      <div class="tt-row">
        <div class="tt-score" style="color:var(--danger);">80–100</div>
        <div><span class="panel-badge badge-danger">CRITICAL</span></div>
        <div class="tt-desc">Stockout likely before replenishment arrives. Immediate revenue impact if unaddressed.</div>
        <div class="tt-action">Emergency reorder or inter-store transfer. Consider flagging low stock on website.</div>
      </div>
      <div class="tt-row">
        <div class="tt-score" style="color:var(--warn);">60–79</div>
        <div><span class="panel-badge badge-warn">ELEVATED</span></div>
        <div class="tt-desc">Stock below historical norms with moderate depletion pressure. Risk real but not urgent.</div>
        <div class="tt-action">Pre-stage stockroom units to floor. Add to next replenishment order.</div>
      </div>
      <div class="tt-row">
        <div class="tt-score" style="color:var(--warn);opacity:0.7;">40–59</div>
        <div><span class="panel-badge badge-warn">MONITOR</span></div>
        <div class="tt-desc">Below average but within acceptable range. Worth watching over next 24 hours.</div>
        <div class="tt-action">Include in next scheduled replenishment review. No urgent action.</div>
      </div>
      <div class="tt-row">
        <div class="tt-score" style="color:var(--ok);">0–39</div>
        <div><span class="panel-badge badge-ok">HEALTHY</span></div>
        <div class="tt-desc">Stock levels adequate relative to current sell rate and lead time window.</div>
        <div class="tt-action">No action required. Model confidence is high.</div>
      </div>
    </div>

  </div> <!-- /page-summary -->

  <!-- PAGE: INTEGRATION FLOWCHART -->
  <div id="page-flowchart" class="page" style="display:none;">

    <!-- Problem / Solution Banner -->
    <div style="display:flex;flex-direction:row;border:1px solid var(--border);border-radius:2px;overflow:hidden;margin-bottom:40px;">
      <div style="flex:1;padding:40px 44px;background:rgba(184,50,50,0.04);border-right:1px solid var(--border);min-width:0;">
        <div class="ps-label">The Problem</div>
        <div class="ps-title">Two systems that can't talk to each other</div>
        <div class="ps-body">Retail stores use smart RFID tags to track every single item on the floor — which jacket is on which rack, which ones are in the back. But Square, the checkout system, has no idea any of that exists. It just knows "you have 3 blue jackets." When you sell one, it goes to 2. That's it.</div>
        <div class="ps-body" style="margin-top:10px;">The result: your website says "in stock" when the shelf is empty. Associates waste time counting manually. You only find out you've run out after you've already lost the sale.</div>
      </div>
      <div style="width:60px;flex-shrink:0;display:flex;align-items:center;justify-content:center;background:var(--surface2);border-left:1px solid var(--border);border-right:1px solid var(--border);">
        <span style="font-size:22px;color:var(--accent);font-family:var(--mono);">→</span>
      </div>
      <div style="flex:1;padding:40px 44px;background:rgba(45,125,82,0.04);min-width:0;">
        <div class="ps-label" style="color:var(--ok);">The Solution</div>
        <div class="ps-title">A translator that sits between both systems</div>
        <div class="ps-body">SquareFlow acts as the bridge. It reads the detailed item-by-item data from the RFID system, converts it into the simple counts that Square understands, and keeps both sides in sync automatically — every time a scan happens or a sale is made.</div>
        <div class="ps-body" style="margin-top:10px;">The result: Square always shows accurate stock. Your website reflects what's actually on the shelf. And an AI engine warns you before you run out — not after.</div>
      </div>
    </div>

    <!-- MAIN FLOWCHART -->
    <div class="fc-section-label">How It Works: From Tag on a Garment to Count in Square</div>
    <div class="fc-chart">

      <!-- Layer 1: Physical -->
      <div class="fc-layer">
        <div class="fc-layer-label">Step 1 · The Tag on the Clothes</div>
        <div class="fc-nodes">
          <div class="fc-node fc-node-physical">
            <div class="fc-node-header">
            <div class="fc-node-icon">🏷</div>
            <div class="fc-node-title">RFID Tag</div>
          </div>
            <div class="fc-node-detail">A tiny chip sewn into every garment — at the factory or warehouse before it ships to the store. Each chip has two things stored on it: a unique ID for that specific item, and a product code for what type of item it is.</div>
            <div class="fc-node-code">Unique item ID: 3034257BF4…A01<br>Product code: BJM-001-BLU-M</div>
          </div>
          <div class="fc-arrow-h">→</div>
          <div class="fc-node fc-node-physical">
            <div class="fc-node-header">
            <div class="fc-node-icon">📡</div>
            <div class="fc-node-title">Handheld Scanner</div>
          </div>
            <div class="fc-node-detail">A store associate walks the floor with a scanner that reads all the chips at once — no need to pick up each item or scan a barcode. It can read through shelves, boxes, and clothing racks in seconds.</div>
            <div class="fc-node-code">~500 items per minute<br>99%+ accurate</div>
          </div>
        </div>
      </div>

      <div class="fc-arrow-v">↓</div>

      <!-- Layer 2: iD Cloud -->
      <div class="fc-layer">
        <div class="fc-layer-label">Step 2 · The RFID Brain (Nedap iD Cloud)</div>
        <div class="fc-nodes fc-nodes-wide">
          <div class="fc-node fc-node-idcloud">
            <div class="fc-node-header">
            <div class="fc-node-icon">☁️</div>
            <div class="fc-node-title">Item Database</div>
          </div>
            <div class="fc-node-detail">Every item the scanner finds gets saved with its location and status. Think of it as a spreadsheet where each row is one individual garment — not just "3 blue jackets" but jacket #1, jacket #2, and jacket #3, each with its own row.</div>
            <div class="fc-node-code">status: on the floor<br>location: floor or stockroom</div>
          </div>
          <div class="fc-arrow-h">→</div>
          <div class="fc-node fc-node-idcloud">
            <div class="fc-node-header">
            <div class="fc-node-icon">📊</div>
            <div class="fc-node-title">Store Dashboard</div>
          </div>
            <div class="fc-node-detail">Shows staff what's on the floor vs. in the back room, what needs to be moved out front, and which items are available for online pickup or ship-from-store orders.</div>
            <div class="fc-node-code">Floor: 2 · Stockroom: 1<br>Available for pickup: yes</div>
          </div>
          <div class="fc-arrow-h">→</div>
          <div class="fc-node fc-node-idcloud">
            <div class="fc-node-header">
            <div class="fc-node-icon">🔍</div>
            <div class="fc-node-title">Theft Detection</div>
          </div>
            <div class="fc-node-detail">Automatically flags when items go missing without a sale — comparing what was scanned this week vs. last week. It can tell the difference between "items misplaced in the back" and "items that walked out the door."</div>
            <div class="fc-node-code">Missing items flagged<br>Likely cause: identified</div>
          </div>
        </div>
      </div>

      <div class="fc-arrow-v">↓</div>

      <!-- Layer 3: SquareFlow Middleware -->
      <div class="fc-layer fc-layer-hero">
        <div class="fc-layer-label" style="color:var(--accent);">Step 3 · SquareFlow — The Translation Layer</div>
        <div class="fc-nodes fc-nodes-wide">
          <div class="fc-node fc-node-sf">
            <div class="fc-node-header">
            <div class="fc-node-icon">⚙️</div>
            <div class="fc-node-title">Item Counter</div>
          </div>
            <div class="fc-node-detail">The RFID system knows about individual items. Square only wants to know totals. This step takes the long list of individual items and adds them up by product type — turning 30 individual item records into 14 product counts.</div>
            <div class="fc-node-code">30 individual items →<br>Blue Jacket / M: 3 total</div>
          </div>
          <div class="fc-arrow-h">→</div>
          <div class="fc-node fc-node-sf fc-node-sf-main">
            <div class="fc-node-header">
            <div class="fc-node-icon">🧠</div>
            <div class="fc-node-title">AI Risk Engine</div>
          </div>
            <div class="fc-node-detail">Before sending anything to Square, the AI asks: "Based on how fast this item is selling and how long restocking takes, will we run out?" It gives each product a risk score from 0–100 and recommends action before the shelf empties.</div>
            <div class="fc-node-code">Risk score: 87 / 100<br>Action: reorder now</div>
          </div>
          <div class="fc-arrow-h">→</div>
          <div class="fc-node fc-node-sf">
            <div class="fc-node-header">
            <div class="fc-node-icon">🗺</div>
            <div class="fc-node-title">ID Translator</div>
          </div>
            <div class="fc-node-detail">The RFID system and Square use different names for the same products. This step looks up the matching Square ID for each product code — like a translation dictionary — before sending the counts over.</div>
            <div class="fc-node-code">Our code: BJM-001-BLU-M<br>Square's ID: LJCY6ZQ…</div>
          </div>
        </div>
        <div class="fc-hero-note">
          SquareFlow is the only piece that understands both sides — individual item tracking and simple product counts
        </div>
      </div>

      <div class="fc-arrow-v">↓</div>

      <!-- Layer 4: Square -->
      <div class="fc-layer">
        <div class="fc-layer-label">Step 4 · Square (Your Checkout System)</div>
        <div class="fc-nodes fc-nodes-wide">
          <div class="fc-node fc-node-square">
            <div class="fc-node-header">
            <div class="fc-node-icon">🔲</div>
            <div class="fc-node-title">Stock Update</div>
          </div>
            <div class="fc-node-detail">Square receives the fresh product counts and updates its inventory. It's told these are physical counts — meaning "we actually counted these items in the store" — so it trusts them and overwrites whatever number it had before.</div>
            <div class="fc-node-code">Blue Jacket / M: 3 units<br>Store: Michigan Ave</div>
          </div>
          <div class="fc-arrow-h">→</div>
          <div class="fc-node fc-node-square">
            <div class="fc-node-header">
            <div class="fc-node-icon">🏪</div>
            <div class="fc-node-title">Checkout Terminal</div>
          </div>
            <div class="fc-node-detail">The register and your website now show accurate stock. When a customer checks if their size is available nearby, the answer reflects what was actually scanned on the floor — not a stale number from days ago.</div>
            <div class="fc-node-code">Website: "3 in stock"<br>Updated from real scan ✓</div>
          </div>
          <div class="fc-arrow-h">→</div>
          <div class="fc-node fc-node-square">
            <div class="fc-node-header">
            <div class="fc-node-icon">💳</div>
            <div class="fc-node-title">Sale Notification</div>
          </div>
            <div class="fc-node-detail">Every time a sale goes through, Square sends a message back to SquareFlow: "one Blue Jacket / M just sold." SquareFlow marks one of the individual jacket chips as sold in the RFID system, keeping both sides in sync.</div>
            <div class="fc-node-code">Sale complete →<br>Item #A01 marked as sold</div>
          </div>
        </div>
      </div>

    </div>
    <!-- end fc-chart -->

    <!-- ENTERPRISE SCALE SECTION -->
    <div class="fc-section-label" style="margin-top:56px;">Scaling Up: From One Store to Hundreds</div>
    <div class="fc-scale-intro">
      The same setup works whether you have one store or eight hundred. The key is that adding a new store doesn't require rebuilding anything — you just plug in the new location and it works.
    </div>

    <div class="fc-scale-grid">

      <div class="fc-scale-card">
        <div class="fc-scale-tier">Tier 1</div>
        <div class="fc-scale-tier-name">Getting Started</div>
        <div class="fc-scale-stores">1–5 stores</div>
        <ul class="fc-scale-list">
          <li>One RFID system, one Square account</li>
          <li>A simple list maps your product codes to Square's IDs</li>
          <li>Sync runs automatically a few times a day</li>
          <li>Staff get risk alerts and decide manually when to reorder</li>
          <li>Quick to set up — no major IT work needed</li>
        </ul>
        <div class="fc-scale-complexity">Effort to set up: <span style="color:var(--ok);">Low</span></div>
      </div>

      <div class="fc-scale-card fc-scale-card-mid">
        <div class="fc-scale-tier">Tier 2</div>
        <div class="fc-scale-tier-name">Growing Chain</div>
        <div class="fc-scale-stores">6–100 stores</div>
        <ul class="fc-scale-list">
          <li>Each store has its own RFID scanner and Square location</li>
          <li>SquareFlow runs the same sync for every store simultaneously</li>
          <li>AI can compare stock across nearby stores — "Store A is running low, Store B has extra, suggest a transfer"</li>
          <li>Sales from all locations feed back in real time</li>
          <li>No additional setup per store — just add a new row to the location list</li>
        </ul>
        <div class="fc-scale-complexity">Effort to set up: <span style="color:var(--warn);">Medium</span></div>
      </div>

      <div class="fc-scale-card fc-scale-card-enterprise">
        <div class="fc-scale-tier">Tier 3</div>
        <div class="fc-scale-tier-name">Enterprise Fleet</div>
        <div class="fc-scale-stores">100–810+ stores</div>
        <ul class="fc-scale-list">
          <li>All 810+ stores sync in parallel — each one independent, none blocking the others</li>
          <li>The RFID system becomes the single source of truth across the entire company</li>
          <li>AI risk scores trigger automatic reorder suggestions — no manual review needed at scale</li>
          <li>Website "available at a store near you" pulls from live RFID data, not estimates</li>
          <li>Adding a new store is a one-line change — the core system never needs to be rebuilt</li>
          <li>AI improves over time as it learns patterns from hundreds of locations</li>
        </ul>
        <div class="fc-scale-complexity">Effort to set up: <span style="color:var(--danger);">High — but the design never changes</span></div>
      </div>

    </div>

    <!-- Key architecture principles -->
    <div class="fc-section-label" style="margin-top:48px;">Four Reasons This Keeps Working as You Grow</div>
    <div class="fc-principles">
      <div class="fc-principle">
        <div class="fc-p-num">01</div>
        <div>
          <div class="fc-p-title">Each sync is independent</div>
          <div class="fc-p-desc">Every time SquareFlow runs, it starts fresh — reads the latest scan, does its work, and sends the update. It doesn't rely on what happened last time. That means you can add more stores or run syncs more frequently without anything breaking.</div>
        </div>
      </div>
      <div class="fc-principle">
        <div class="fc-p-num">02</div>
        <div>
          <div class="fc-p-title">Safe to retry if something goes wrong</div>
          <div class="fc-p-desc">Every update sent to Square is stamped with a unique ID (store name + time). If the sync fails halfway through and runs again, Square recognizes it's a retry and won't count the inventory twice. This matters a lot when you're running hundreds of stores at once.</div>
        </div>
      </div>
      <div class="fc-principle">
        <div class="fc-p-num">03</div>
        <div>
          <div class="fc-p-title">Adding a store takes one line of setup</div>
          <div class="fc-p-desc">Each store just needs one entry in the location list — its RFID store ID and its Square location ID. No code changes, no redeployment. The same products might have different Square IDs in different regions, and that's handled automatically.</div>
        </div>
      </div>
      <div class="fc-principle">
        <div class="fc-p-num">04</div>
        <div>
          <div class="fc-p-title">The AI gets smarter as you grow</div>
          <div class="fc-p-desc">The risk model only needs three pieces of information that exist for every product at every store: how fast it's selling, how much is left, and how long restocking takes. No custom setup per store. And as you add more locations, the AI has more data to learn from — so predictions actually improve at scale.</div>
        </div>
      </div>
    </div>

  </div> <!-- /page-flowchart -->

</div>

<!-- Footer -->
<div class="container">
  <footer>
    <div class="footer-inner">
      <div class="footer-text">
        <div>RFID ↔ Square Inventory Sync</div>
        <div>Risk model: weighted multi-signal scoring</div>
      </div>
      <div class="footer-brand">
        <div class="footer-logo">SquareFlow</div>
        <div class="footer-tag">PORTFOLIO PROJECT</div>
      </div>
    </div>
  </footer>
</div>

<script>
// =============================================================================
// PAGE NAVIGATION
// =============================================================================
function showPage(name) {
  document.getElementById('page-problem').style.display    = name === 'problem'    ? 'block' : 'none';
  document.getElementById('page-discovery').style.display  = name === 'discovery'  ? 'block' : 'none';
  document.getElementById('page-dashboard').style.display  = name === 'dashboard'  ? 'block' : 'none';
  document.getElementById('page-summary').style.display    = name === 'summary'    ? 'block' : 'none';
  document.getElementById('page-flowchart').style.display  = name === 'flowchart'  ? 'block' : 'none';
  document.getElementById('nav-problem').classList.toggle('active',    name === 'problem');
  document.getElementById('nav-discovery').classList.toggle('active',  name === 'discovery');
  document.getElementById('nav-dashboard').classList.toggle('active',  name === 'dashboard');
  document.getElementById('nav-summary').classList.toggle('active',    name === 'summary');
  document.getElementById('nav-flowchart').classList.toggle('active',  name === 'flowchart');
  window.scrollTo({ top: 0, behavior: 'smooth' });
}

// =============================================================================
// DATA — Mock inventory state (simulates what middleware receives from iD Cloud)
// =============================================================================
const SKUS = [
  {
    id: "BJM-001-BLU-M",
    name: "Classic Denim Jacket",
    variant: "Blue / M",
    stock: 3,
    floorStock: 2,
    stockroomStock: 1,
    baseVelocity: 1.8,    // units sold per day at baseline
    leadTime: 24,         // hours to replenishment
    historicalAvg: 4.2,   // avg stock at this time of week
    dayOfWeekFactor: 1.3, // Friday multiplier
  },
  {
    id: "LGG-330-BLK-S",
    name: "High-Waist Leggings",
    variant: "Black / S",
    stock: 2,
    floorStock: 2,
    stockroomStock: 0,
    baseVelocity: 2.4,
    leadTime: 24,
    historicalAvg: 5.1,
    dayOfWeekFactor: 1.4,
  },
  {
    id: "CNO-210-GRY-XL",
    name: "Oversized Knit Cardigan",
    variant: "Grey / XL",
    stock: 1,
    floorStock: 1,
    stockroomStock: 0,
    baseVelocity: 0.9,
    leadTime: 36,
    historicalAvg: 2.8,
    dayOfWeekFactor: 1.1,
  },
  {
    id: "SWE-502-CRM-M",
    name: "Ribbed Crew Sweater",
    variant: "Cream / M",
    stock: 1,
    floorStock: 1,
    stockroomStock: 0,
    baseVelocity: 1.2,
    leadTime: 24,
    historicalAvg: 3.0,
    dayOfWeekFactor: 1.2,
  },
  {
    id: "WTS-044-WHT-XS",
    name: "Linen Wrap Top",
    variant: "White / XS",
    stock: 2,
    floorStock: 2,
    stockroomStock: 0,
    baseVelocity: 1.1,
    leadTime: 18,
    historicalAvg: 2.5,
    dayOfWeekFactor: 1.0,
  },
  {
    id: "BJM-001-BLK-S",
    name: "Classic Denim Jacket",
    variant: "Black / S",
    stock: 2,
    floorStock: 2,
    stockroomStock: 0,
    baseVelocity: 0.7,
    leadTime: 24,
    historicalAvg: 2.0,
    dayOfWeekFactor: 0.9,
  },
  {
    id: "WTS-044-WHT-M",
    name: "Linen Wrap Top",
    variant: "White / M",
    stock: 2,
    floorStock: 1,
    stockroomStock: 1,
    baseVelocity: 0.8,
    leadTime: 18,
    historicalAvg: 3.0,
    dayOfWeekFactor: 1.0,
  },
  {
    id: "BJM-001-BLU-L",
    name: "Classic Denim Jacket",
    variant: "Blue / L",
    stock: 4,
    floorStock: 2,
    stockroomStock: 2,
    baseVelocity: 1.5,
    leadTime: 24,
    historicalAvg: 4.5,
    dayOfWeekFactor: 1.1,
  },
  {
    id: "WTS-044-WHT-S",
    name: "Linen Wrap Top",
    variant: "White / S",
    stock: 3,
    floorStock: 2,
    stockroomStock: 1,
    baseVelocity: 1.3,
    leadTime: 18,
    historicalAvg: 3.5,
    dayOfWeekFactor: 1.1,
  },
  {
    id: "CNO-210-GRY-M",
    name: "Oversized Knit Cardigan",
    variant: "Grey / M",
    stock: 2,
    floorStock: 2,
    stockroomStock: 0,
    baseVelocity: 0.6,
    leadTime: 36,
    historicalAvg: 2.2,
    dayOfWeekFactor: 1.0,
  },
  {
    id: "LGG-330-BLK-M",
    name: "High-Waist Leggings",
    variant: "Black / M",
    stock: 2,
    floorStock: 1,
    stockroomStock: 1,
    baseVelocity: 1.9,
    leadTime: 24,
    historicalAvg: 4.0,
    dayOfWeekFactor: 1.3,
  },
  {
    id: "SWE-502-CRM-S",
    name: "Ribbed Crew Sweater",
    variant: "Cream / S",
    stock: 2,
    floorStock: 2,
    stockroomStock: 0,
    baseVelocity: 1.0,
    leadTime: 24,
    historicalAvg: 2.8,
    dayOfWeekFactor: 1.1,
  },
  {
    id: "CNO-210-GRY-L",
    name: "Oversized Knit Cardigan",
    variant: "Grey / L",
    stock: 3,
    floorStock: 2,
    stockroomStock: 1,
    baseVelocity: 0.8,
    leadTime: 36,
    historicalAvg: 3.2,
    dayOfWeekFactor: 1.0,
  },
  {
    id: "LGG-330-BLK-L",
    name: "High-Waist Leggings",
    variant: "Black / L",
    stock: 1,
    floorStock: 1,
    stockroomStock: 0,
    baseVelocity: 1.4,
    leadTime: 24,
    historicalAvg: 3.0,
    dayOfWeekFactor: 1.2,
  },
];

// =============================================================================
// AI SCORING ENGINE
// The core model — weights three signals into a 0–100 risk score
// =============================================================================
function scoreRisk(sku, sim) {
  const velocity = sku.baseVelocity * sku.dayOfWeekFactor * sim.velocityMult;
  const effectiveStock = Math.max(0, sku.stock - sim.buffer);
  const leadTime = sim.leadTime;

  // Signal 1: Velocity signal (0–1)
  // How fast is this SKU burning relative to what's on hand?
  const hoursOfStock = effectiveStock > 0 ? (effectiveStock / velocity) * 24 : 0;
  const velocitySignal = Math.min(1, leadTime / Math.max(hoursOfStock, 0.1));

  // Signal 2: Stock signal (0–1)
  // How depleted vs. historical average?
  const stockSignal = Math.min(1, 1 - (sku.stock / Math.max(sku.historicalAvg, 1)));

  // Signal 3: Lead time pressure (0–1)
  // If we ordered now, would it arrive in time?
  const leadPressure = Math.min(1, leadTime / Math.max(hoursOfStock, 1));

  // Weighted combination — these weights are the "model"
  const raw = (velocitySignal * 0.45) + (stockSignal * 0.35) + (leadPressure * 0.20);
  const score = Math.round(Math.min(100, Math.max(0, raw * 110)));

  return {
    score,
    velocity: velocity.toFixed(1),
    hoursOfStock: hoursOfStock.toFixed(1),
    velocitySignal: (velocitySignal * 100).toFixed(0),
    stockSignal: (stockSignal * 100).toFixed(0),
    leadPressure: (leadPressure * 100).toFixed(0),
  };
}

function riskLevel(score) {
  if (score >= 80) return { label: 'CRITICAL', cls: 'danger', badgeCls: 'badge-danger' };
  if (score >= 40) return { label: 'ELEVATED', cls: 'warn', badgeCls: 'badge-warn' };
  return { label: 'HEALTHY', cls: 'ok', badgeCls: 'badge-ok' };
}

function actionText(score, sku, scored) {
  if (score >= 80) return { text: 'URGENT REORDER', cls: 'badge-danger' };
  if (score >= 60) return { text: 'REVIEW STOCK', cls: 'badge-warn' };
  if (score >= 40) return { text: 'MONITOR', cls: 'badge-warn' };
  return { text: 'NO ACTION', cls: 'badge-ok' };
}

function generateReasoning(sku, scored, sim) {
  const level = riskLevel(scored.score);
  const velocity = parseFloat(scored.velocity);
  const hours = parseFloat(scored.hoursOfStock);

  let text = '';
  if (scored.score >= 80) {
    text = `At the current sell rate of ${velocity} units/day, this SKU has approximately ${hours < 24 ? hours + 'h' : Math.round(hours/24) + ' days'} of stock remaining — less than the ${sim.leadTime}h replenishment lead time. The model weights velocity (${scored.velocitySignal}%) and lead time pressure (${scored.leadPressure}%) as primary drivers. Immediate action is required to avoid a stockout.`;
  } else if (scored.score >= 40) {
    text = `Stock level is below historical average for this SKU at this point in the week (currently ${sku.stock} vs. avg ${sku.historicalAvg}). At ${velocity} units/day, the ${sim.leadTime}h lead time creates moderate risk. The model flags this as elevated — worth monitoring and pre-staging stockroom units to the floor.`;
  } else {
    text = `Stock levels are adequate relative to the current sell rate of ${velocity} units/day. With ${hours}h of runway and a ${sim.leadTime}h lead time, the model estimates low stockout probability. No action required at this time.`;
  }
  return text;
}

function generateRecommendation(sku, scored, sim) {
  if (scored.score >= 80) {
    return {
      action: `Initiate emergency replenishment or inter-store transfer`,
      detail: `Check nearby locations for available units. If transferring, allow ${sim.leadTime}h. Consider marking low on website to manage demand.`,
      confidence: 92
    };
  }
  if (scored.score >= 60) {
    return {
      action: `Pre-stage stockroom units to floor today`,
      detail: `${sku.stockroomStock > 0 ? sku.stockroomStock + ' unit(s) in stockroom available to move.' : 'No stockroom buffer — flag for next replenishment order.'} Reorder if not already queued.`,
      confidence: 78
    };
  }
  if (scored.score >= 40) {
    return {
      action: `Include in next scheduled replenishment review`,
      detail: `Stock is below weekly average. No urgent action, but add to watchlist for next 24h rescan.`,
      confidence: 65
    };
  }
  return {
    action: `No action required`,
    detail: `Model confidence is high that this SKU will not experience stockout within the lead time window.`,
    confidence: 88
  };
}

// =============================================================================
// STATE
// =============================================================================
let selectedId = null;
let sim = { velocityMult: 1, leadTime: 24, buffer: 1 };

// =============================================================================
// RENDER
// =============================================================================
function getScoredSkus() {
  return SKUS.map(sku => ({ sku, scored: scoreRisk(sku, sim) }))
    .sort((a, b) => b.scored.score - a.scored.score);
}

function updateStats(scored) {
  const critical = scored.filter(s => s.scored.score >= 80).length;
  const elevated = scored.filter(s => s.scored.score >= 40 && s.scored.score < 80).length;
  const healthy = scored.filter(s => s.scored.score < 40).length;
  const critHours = scored.filter(s => s.scored.score >= 80).map(s => parseFloat(s.scored.hoursOfStock));
  const avgHours = critHours.length ? (critHours.reduce((a,b)=>a+b,0)/critHours.length).toFixed(1) : '—';

  document.getElementById('stat-critical').textContent = critical;
  document.getElementById('stat-elevated').textContent = elevated;
  document.getElementById('stat-healthy').textContent = healthy;
  document.getElementById('stat-hours').textContent = avgHours + (avgHours !== '—' ? 'h' : '');
}

function renderRows(scored) {
  const container = document.getElementById('sku-rows');
  container.innerHTML = '';

  scored.forEach(({ sku, scored: s }, i) => {
    const level = riskLevel(s.score);
    const action = actionText(s.score, sku, s);
    const row = document.createElement('div');
    row.className = 'sku-row' + (sku.id === selectedId ? ' selected' : '');
    row.style.animationDelay = (i * 0.05) + 's';
    row.innerHTML = `
      <div>
        <div class="sku-name">${sku.name}</div>
        <div class="sku-code">${sku.id} · ${sku.variant}</div>
      </div>
      <div class="sku-stock" style="color:var(--${level.cls})">${sku.stock}</div>
      <div class="sku-velocity" style="color:var(--muted)">${s.velocity}<span style="font-size:10px">/day</span></div>
      <div class="risk-bar-wrap">
        <div class="risk-bar-bg">
          <div class="risk-bar-fill risk-${level.cls === 'danger' ? 'high' : level.cls === 'warn' ? 'med' : 'low'}" style="width:${s.score}%"></div>
        </div>
        <div class="risk-pct" style="color:var(--${level.cls})">${s.score}%</div>
      </div>
      <div><span class="action-pill ${action.cls}">${action.text}</span></div>
    `;
    row.addEventListener('click', () => selectSku(sku.id));
    container.appendChild(row);
  });
}

function selectSku(id) {
  selectedId = id;
  renderAll();
  renderDetail();
}

function renderDetail() {
  const content = document.getElementById('detail-content');
  const badge = document.getElementById('detail-badge');

  if (!selectedId) {
    badge.textContent = 'SELECT ROW';
    badge.className = 'panel-badge badge-accent';
    content.innerHTML = `<div class="detail-empty"><div class="arrow">←</div><div>Select a SKU to inspect<br>the model's reasoning</div></div>`;
    return;
  }

  const sku = SKUS.find(s => s.id === selectedId);
  const scored = scoreRisk(sku, sim);
  const level = riskLevel(scored.score);
  const reasoning = generateReasoning(sku, scored, sim);
  const rec = generateRecommendation(sku, scored, sim);

  badge.textContent = level.label;
  badge.className = 'panel-badge ' + level.badgeCls;

  content.innerHTML = `
    <div class="detail-sku-name">${sku.name}</div>
    <div class="detail-sku-code">${sku.id} · ${sku.variant}</div>

    <div class="risk-score-display">
      <div class="risk-number" style="color:var(--${level.cls})">${scored.score}</div>
      <div class="risk-label" style="color:var(--${level.cls})">${level.label} RISK</div>
    </div>

    <div class="signal-grid">
      <div class="signal-card">
        <div class="signal-label">Velocity Signal</div>
        <div class="signal-value" style="color:var(--accent2)">${scored.velocitySignal}%</div>
        <div class="signal-sub">${scored.velocity} units/day · weight 0.45</div>
      </div>
      <div class="signal-card">
        <div class="signal-label">Stock Depletion</div>
        <div class="signal-value" style="color:var(--warn)">${scored.stockSignal}%</div>
        <div class="signal-sub">${sku.stock} of ${sku.historicalAvg} avg · weight 0.35</div>
      </div>
      <div class="signal-card">
        <div class="signal-label">Lead Time Pressure</div>
        <div class="signal-value" style="color:var(--danger)">${scored.leadPressure}%</div>
        <div class="signal-sub">${sim.leadTime}h lead · weight 0.20</div>
      </div>
      <div class="signal-card">
        <div class="signal-label">Hours of Stock</div>
        <div class="signal-value">${scored.hoursOfStock}h</div>
        <div class="signal-sub">floor: ${sku.floorStock} · back: ${sku.stockroomStock}</div>
      </div>
    </div>

    <div class="reasoning-box">
      <div class="reasoning-label">// AI REASONING</div>
      <div class="reasoning-text">${reasoning}</div>
    </div>

    <div class="recommendation">
      <div class="rec-label">// RECOMMENDED ACTION</div>
      <div class="rec-action">${rec.action}</div>
      <div class="rec-detail">${rec.detail}</div>
      <div class="confidence-bar">
        <span class="conf-label">CONFIDENCE</span>
        <div class="conf-track"><div class="conf-fill" style="width:${rec.confidence}%"></div></div>
        <span class="conf-pct">${rec.confidence}%</span>
      </div>
    </div>
  `;
}

function renderAll() {
  const scored = getScoredSkus();
  updateStats(scored);
  renderRows(scored);
}

// =============================================================================
// SIMULATOR CONTROLS
// =============================================================================
document.getElementById('sim-velocity').addEventListener('input', function() {
  sim.velocityMult = parseFloat(this.value);
  document.getElementById('sim-velocity-val').textContent = sim.velocityMult.toFixed(1) + '× baseline';
  renderAll();
  if (selectedId) renderDetail();
});

document.getElementById('sim-lead').addEventListener('input', function() {
  sim.leadTime = parseInt(this.value);
  document.getElementById('sim-lead-val').textContent = sim.leadTime + ' hrs';
  renderAll();
  if (selectedId) renderDetail();
});

document.getElementById('sim-buffer').addEventListener('input', function() {
  sim.buffer = parseInt(this.value);
  document.getElementById('sim-buffer-val').textContent = sim.buffer + ' unit' + (sim.buffer !== 1 ? 's' : '');
  renderAll();
  if (selectedId) renderDetail();
});

// =============================================================================
// INIT
// =============================================================================
renderAll();
</script>
</body>
</html>
